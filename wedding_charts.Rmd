---
title: "&nbsp;"
output:
  html_document:
    author: "Karina and Neil"
    df_print: paged
  html_notebook:
    toc: true
    toc_float: true
---

```{=html}
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-W9SRJ6HG');</script>
<!-- End Google Tag Manager -->
```
```{r, echo = FALSE}
# Change to html if necessary
#
#<!-- html code to remove Rmarkdown size containment -->
#
#<style type="text/css">
#.main-container {
#  max-width: 100% !important;
#  margin: auto;
#}
#</style>
```

```{=html}

<style>
    body { background-color: #FFFFFF; }
    pre, pre:not([class]) { background-color: #FFFFFF; }
</style>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W9SRJ6HG"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
```
```{=html}

<style type="text/css">
.hovertext text {
    font-size: 18px !important;
    font-family: Georgia, serif;
}
</style>
```
```{css, echo=FALSE}
p {
  font-size: 18px;
  font-family: Georgia, serif;
}
```

```{css, echo=FALSE}
/* add this css to your stylesheet or add it within a style tag in the head of your document */

.js div#preloader {
  position: fixed;
  left: 0;
  top: 0;
  z-index: 999;
  width: 100%;
  height: 100%;
  overflow: visible;
  
  /* You can change the background color and image URL here.  This solution works with animated .svg and animated .gif */
  background: #ffffff url('https://raw.githubusercontent.com/ndyetz/ourloveinnumbers.github.io/refs/heads/main/loading_gif.gif') no-repeat center center;
}

```

```{=html}
<div id="preloader"></div>
```
```{js, echo=FALSE}


// add the javascript below to the head of your doc inside a script tag

// this line adds a class of js to your html element, we add the class with javascript instead of just putting it in the html so if javascript isn't available, the preloader does not show up, because without javascript it won't fade out and would just be there forever.
document.documentElement.classList.add("js");

// dom is loaded
jQuery(document).ready(function($) {  
// fade out preloader
$('#preloader').fadeOut('slow',function(){$(this).remove();});

});

```

```{css, echo=FALSE}
h1 {
  font-family: Georgia, serif;
  font-weight: bold;
  color: #64798B;
  text-align: center;
}

```

```{css, echo = FALSE}
  .nav-pills>li>a:hover, .nav-pills>li>a:focus, .nav-pills>li.active>a,   .nav-pills>li.active>a:hover, .nav-pills>li.active>a:focus{
  background-color: #64798B;
  font-weight: bold;
  text-align: center;
  font-color: "white";
}


.nav-pills {
  text-align: center;
}
```

```{css, echo=FALSE}

.break .nav-pills {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  text-align: center;
}

.break .nav-pills:before,
.break .nav-pills:after {
  content: unset;
}
```

```{r, message = FALSE, echo = FALSE, warning = FALSE}
#Clear Environment
#rm(list = ls())
```

```{r, message = FALSE, echo = FALSE, warning = FALSE}

#Currently being run in "run.R"

#Libraries and functions (Includes Dates)
#source("source_functions.R")

# Load data and formatting
#source("source_file.R")

# Google API. for google_maps(). Function will not work without API key.
#source("private_key.R")
```

# Have Fun Clicking Through the Tabs Below {.tabset .tabset-fade .tabset-pills .break}

## Home<br>Page {.tabset .tabset-fade .tabset-pills}

<center>![](mountain_website.png){width="50%"}</center>

<center>![](love_in_charts.png){width="80%"}</center>

<center>![](names.png){width="30%"}</center>

<center>![](together_graphs2.png){width="70%"}</center>

<br>

<p style="font-family: Georgia, serif; font-size:10pt; font-style:bold">

<center>What better way to show our love than with data-driven charts and analyses? Each tab above provides insights to our love using various data sources. We pulled data from our phone service providers, annual ski passes, credit card statements, and more!</center>

</p>

## Texting<br>Data {.tabset .tabset-fade .tabset-pills}

**We downloaded all of our text messaging data over the course of our relationship from T-Mobile and Verizon. We provide some insights in the tabs below. Enjoy!**

### Our Texts Over Time {.tabset .tabset-fade .tabset-pills}

**Our first winter together, texting \~600 times a week was the norm. Since Neil moved in, our texting slowed down quite a bit.**

```{r, echo = FALSE, out.height= "100%", out.width = "100%", warning = FALSE}
#Custom Functions
p_texts_quant_time <- line_plots_quant(data = texts_quant_graph, x = week_of, y = `# of texts sent`)
hover_range_quant(p_texts_quant_time)
```

<sup>*Hover over the chart and milestones for more information about our milestones and texting. Or click on the chart legend to show/hide any additional relationship milestones.*</sup>

**There seems to be a *slight* downward trend in the length of the texts that we send each other - however, certain events cause outliers.**

**The week after we got engaged, Neil's texting character count increased dramatically!**

```{r, echo = FALSE, out.height= "100%", out.width = "100%", warning = FALSE}

texts_char_time_graph <- line_plots_quant(data = texts_char_time, x = week_of, y = `Average character count`)
hover_range_quant(texts_char_time_graph)
```

<sup>*Hover over the chart and milestones for more information about our milestones and texting. Or click on the chart legend to show/hide any additional relationship milestones.*</sup>

### Total<br>Texts {.tabset .tabset-fade .tabset-pills}

<br>

**Neil doesn't always respond!**

```{r, echo = FALSE, out.height= "100%", out.width = "100%"}
#Overall texts

p_sent <- ggplot(text_quant_graph, aes(x = `Sent by`, y = `# of texts sent` , fill = `Sent by`)) +
  geom_col(position = "dodge") +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  geom_text(
    aes(label = paste0(`# of texts sent`, " Texts\n "), lineheight = .83),
    position = position_dodge(.8),
    vjust = 30,
    size = 5) +
  labs(title = "",
       x = "") +
  theme_minimal() +
  #  theme(axis.text.x = element_text(angle = 45,  hjust=1))  +
  theme(axis.text.x = element_text(size=11, face="bold", color = "black"), legend.title=element_blank()) 


ggplotly(p_sent) #%>% 
 # layout(hovermode = 'x')
```

<sup>*Click on the chart legend to show/hide any bars.*</sup>

<br> <br>

**But when Neil responds, he has more to say!**

```{r, echo = FALSE, out.height= "100%", out.width = "100%"}

p_character_sent <- ggplot(text_character_graph, aes(x = `Sent by`, y = `Average number of characters in text` , fill = `Sent by`)) +
  geom_col(position = "dodge") +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  geom_text(
    aes(label = paste0(round(`Average number of characters in text`, 2) , " Avg. Characters \n"), lineheight = .83),
    position = position_dodge(.8),
    vjust = 30,
    size = 5) +
  labs(title = "",
       x = "") +
  theme_classic() +
  #  theme(axis.text.x = element_text(angle = 45,  hjust=1))  +
  theme(axis.text.x = element_text(size=11, face="bold", color = "black"), legend.title=element_blank()) 


ggplotly(p_character_sent) %>% 
#  layout(hovermode = 'x')
  style(hoverinfo = "none", traces = 3:4) 
```

<sup>*Click on the chart legend to show/hide any bars.*</sup>

### Word<br>Cloud {.tabset .tabset-fade .tabset-pills}

**Over the course of our relationship, we texted some words more than others. See our word cloud below.** <br>

```{r, echo = FALSE}
#Word cloud image in markdown below. 
```

**"Baby", "Babe", "Love", and "Lol" are a few of our most frequently used words!**

<center><img src="word_cloud.png" width="80%"/></center>

**"ETA", "BTW", and "FYI" also make the top list.**

### Our Favorite Words to Text {.tabset .tabset-fade .tabset-pills}

#### Overall {.tabset .tabset-fade .tabset-pills}

**Karina texts "*Baby*" a lot, while Neil texts "Babe" more. Neil's 2nd favorite thing to text is "*Laugh Out Loud.*"**

```{r, echo = FALSE, out.height= "100%", out.width = "100%"}
# Count of chosen words.
final_text_search_graph <- final_text_search %>% 
  pivot_longer(-`Sent by`, values_to = "# of times word(s) was used") %>% 
  filter(`Sent by` != "Total") %>% 
    mutate(name = factor(name, levels = c("Baby", "Babe", "Love you", "Ben", "Laika", "Good morning","Good night", "Lol"),    labels = c(1,2,3,4,5,6,7,8)),
         name = factor(name,   labels = c("Baby", "Babe", "Love you", "Ben", "Laika", "Good morning", "Good night", "Lol" ),  levels = c(1,2,3,4,5,6,7,8)),
         ) %>% 
  rename(`Word(s)` = "name")

ptotal <- ggplot(final_text_search_graph, aes(x = `Word(s)`, y = `# of times word(s) was used`, fill = `Sent by`)) +
  geom_col(position = "dodge") +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  geom_text(
    aes(label = paste0(`# of times word(s) was used`, "\n "), lineheight = .83),
    position = position_dodge(.8),
    vjust = 30,
    size = 4.5) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45,  hjust=1))  +
  theme(axis.text.x = element_text(size=11, face="bold", color = "black"), legend.title=element_blank()) +
  labs(title = "",
       x = "") 
  
ggplotly(ptotal)  %>% 
 # layout(hovermode = 'x')
    style(hoverinfo = "none", traces = 3:4) 


```

<sup>*Click on the chart legend to show/hide any bars.*</sup> <sup>(Note: *Ben* is the name of Karina's son and *Laika* is the name of Neil's dog!).</sup>

#### Over Time {.tabset .tabset-fade .tabset-pills}

***W*****e have highlighted certain sections of this graph to tell a few stories. Check out the tabs below to see some interesting trends we found in our texting!**

##### "Love<br>you"

**Right after we decided to make it official, "Love you" made its way into our regular texting. We were quick to say we love each other... And we *love* that!**

```{r, echo = FALSE, fig.height= 10, out.height= "100%", out.width = "100%", warning = FALSE}

love <- texts_combine_filter_graph_groups %>% 
  filter(`Word(s)` == "Love you")

plove <- ggplot(love, aes(x = week_of, y = `Count of particular word(s) used in our texts`, color = `Word(s)`)) +
  geom_line(linewidth = .6) + 
  scale_color_manual(values = c( "#E8AE4C", "#4CD2D6")) +
  facet_wrap(~title) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") + 
  labs(title = "",
       x = "", , color = "&#9644; <b>Word(s)</b><br>&#9670; <b>Milestone</b><br>") +
  theme(
#   strip.background = element_rect(
#     color="#64798B",  linewidth =1, linetype="solid"
#     ),
   strip.text.x = element_text(
        size = 12, color = "black", face = "bold.italic"
        )
   ) +
  geom_point(aes(x = (Relationship)     , y = 25 , color = "Relationship"    ), shape=18, size = 2.5) +
  geom_segment(aes(x=       (Relationship)            ,         xend=   (Relationship)         , y=0, yend= 25, color =            "Relationship"          ), linewidth = .05)


ggplotly(plove) %>% 
  layout(hovermode = 'x') %>% 
   style(hovertext = paste0("We make it official, we decide we want to be in a relationship on " , format(as_date(Relationship), "%b %d, %Y"), '. \nWe also said "I love you" in person for the first time on this day.')                , traces = 3:4  ) %>% 
style(hoverinfo = "none", traces = 5:6) 
```

<sup>*Click on the chart legend to show/hide any milestones or trends.*</sup>

##### "Baby" vs "Babe"

**At the beginning of their relationship, Neil used "Babe" instead of "Baby", but overtime he seems to mimic the way Karina used the word. A significant increase in Neil texting the word "Baby" can be seen after we move in together.**

```{r, echo = FALSE, fig.height= 10, out.height= "100%", out.width = "100%", warning = FALSE}



baby <- texts_combine_filter_graph_groups %>% 
  filter(`Word(s)` == "Baby")

pbaby <- ggplot(baby, aes(x = week_of, y = `Count of particular word(s) used in our texts`, color = `Word(s)`)) +
  geom_line(linewidth = .6) + 
    scale_color_manual(values = c( "#FA9F99", "#EB99F8")) +
  facet_wrap(~title) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") + 
  labs(title = "",
       x = "", color = "&#9644; <b>Word(s)</b><br>&#9670; <b>Milestone</b><br>") +
  theme(
#   strip.background = element_rect(
#     color="#64798B",  linewidth =1, linetype="solid"
#     ),
   strip.text.x = element_text(
        size = 12, color = "black", face = "bold.italic"
        )
   ) +
  geom_point(aes(x = (`Neil moves in`)     , y = 130 , color = "Neil moves in"    ), shape=18, size = 2.5) +
  geom_segment(aes(x=       (`Neil moves in`)            ,         xend=   (`Neil moves in`)         , y=0, yend= 130, color =            "Neil moves in"          ), linewidth = .05) 


ggplotly(pbaby) %>% 
  layout(hovermode = 'x') %>% 
  style(hovertext = paste0("Neil moved in with Karina on "                                     , format(as_date(`Neil moves in`), "%b %d, %Y"), ".")                                                                                   , traces = 3:4 ) %>% 
style(hoverinfo = "none", traces = 5:6)

```

<sup>*Click on the chart legend to show/hide any milestones or trends.*</sup>

**Karina rarely used the word "Babe" to start with!**

```{r, echo = FALSE, fig.height= 10, out.height= "100%", out.width = "100%", warning = FALSE}

  
babe <- texts_combine_filter_graph_groups %>% 
  filter(`Word(s)` == "Babe")

pbabe <- ggplot(babe, aes(x = week_of, y = `Count of particular word(s) used in our texts`, color = `Word(s)`)) +
  geom_line(linewidth = .6) + 
  scale_color_manual(values = c( "#ED813E", "#EB99F8")) +
  facet_wrap(~title) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") + 
  labs(title = "",
       x = "", , color = "&#9644; <b>Word(s)</b><br>&#9670; <b>Milestone</b><br>") +
  theme(
#   strip.background = element_rect(
#     color="#64798B",  linewidth =1, linetype="solid"
#     ),
   strip.text.x = element_text(
        size = 12, color = "black", face = "bold.italic"
        )
   ) +
  geom_point(aes(x = (`Neil moves in`)     , y = 120 , color = "Neil moves in"    ), shape=18, size = 2.5) +
  geom_segment(aes(x=       (`Neil moves in`)            ,         xend=   (`Neil moves in`)         , y=0, yend= 120, color =            "Neil moves in"          ), linewidth = .05)


ggplotly(pbabe) %>% 
  layout(hovermode = 'x') %>% 
  style(hovertext = paste0("Neil moved in with Karina on "                                     , format(as_date(`Neil moves in`), "%b %d, %Y"), ".")                                                                                   , traces = 3:4 ) %>% 
style(hoverinfo = "none", traces = 5:6)

```

<sup>*Click on the chart legend to show/hide any milestones or trends.*</sup>

##### An increase in "Ben" {.tabset .tabset-fade .tabset-pills}

**Notice how Ben (Karina's son) becomes a topic of conversation more frequently after he was introduced to Neil.**

```{r, echo = FALSE, fig.height= 10, out.height= "100%", out.width = "100%", warning = FALSE}


  
ben <- texts_combine_filter_graph_groups %>% 
  filter(`Word(s)` == "Ben")

pben <- ggplot(ben, aes(x = week_of, y = `Count of particular word(s) used in our texts`, color = `Word(s)`)) +
  geom_line(linewidth = .6) + 
  scale_color_manual(values = c( "#DCB54C", "#4CCFE6")) +
  facet_wrap(~title) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") + 
  labs(title = "",
       x = "", , color = "&#9644; <b>Word(s)</b><br>&#9670; <b>Milestone</b><br>") +
  theme(
#   strip.background = element_rect(
#     color="#64798B",  linewidth =1, linetype="solid"
#     ),
   strip.text.x = element_text(
        size = 12, color = "black", face = "bold.italic"
        )
   ) +
  geom_point(aes(x = (`Neil Meets Ben`)     , y = 40 , color = "Neil Meets Ben"    ), shape=18, size = 2.5) +
  geom_segment(aes(x=       (`Neil Meets Ben`)            ,         xend=   (`Neil Meets Ben`)         , y=0, yend= 40, color =            "Neil Meets Ben"          ), linewidth = .05)


ggplotly(pben) %>% 
  layout(hovermode = 'x') %>% 
  style(hovertext = paste0("We go snowboarding with Karina's son, Ben, on "                   , format(as_date(`Neil Meets Ben`), "%b %d, %Y"), ". It's the first time Neil met Ben.")                                                , traces = 3:4  ) %>% 
style(hoverinfo = "none", traces = 5:6)

```

<sup>*Click on the chart legend to show/hide any milestones or trends.*</sup>

<sup>*Note: One of Neil's best friends is also named Ben, so some of this data may be inflated.*</sup>

##### Neil Likes to "Lol" {.tabset .tabset-fade .tabset-pills}

***After we made our relationship official*****, Neil started to "Laugh Out Loud" much more frequently. Karina "Laughed Out Loud" at a pretty low frequency throughout their relationship.**

```{r, echo = FALSE, fig.height= 10, out.height= "100%", out.width = "100%", warning = FALSE}

lol <- texts_combine_filter_graph_groups %>% 
  filter(`Word(s)` == "Lol")



plol <- ggplot(lol, aes(x = week_of, y = `Count of particular word(s) used in our texts`, color = `Word(s)`)) +
  geom_line(linewidth = .6) + 
    scale_color_manual(values = c( "#49B500", "#4CD2D6")) +
  facet_wrap(~title) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") + 
  labs(title = "",
       x = "", color = "&#9644; <b>Word(s)</b><br>&#9670; <b>Milestone</b><br>") +
  theme(
#   strip.background = element_rect(
#     color="#64798B",  linewidth =1, linetype="solid"
#     ),
   strip.text.x = element_text(
        size = 12, color = "black", face = "bold.italic"
        )
   ) +
  geom_point(aes(x = (Relationship)     , y = 120 , color = "Relationship"    ), shape=18, size = 2.5) +
  geom_segment(aes(x=       (Relationship)            ,         xend=   (Relationship)         , y=0, yend= 120, color =            "Relationship"          ), linewidth = .05)


ggplotly(plol) %>% 
  layout(hovermode = 'x') %>% 
   style(hovertext = paste0("We make it official, we decide we want to be in a relationship on " , format(as_date(Relationship), "%b %d, %Y"), '. \nWe also said "I love you" in person for the first time on this day.')                , traces = 3:4  ) %>% 
style(hoverinfo = "none", traces = 5:6) 
```

<sup>*Click on the chart legend to show/hide any milestones or trends.*</sup>

##### The Fall of "Good Morning" {.tabset .tabset-fade .tabset-pills}

**From December through February, we were saying "*Good morning*" to each other nearly everyday. Since the end of February, the number of times we say "Good morning" to each other via text is nearly zero. Although we started "officially" living with each other in August, we have been seeing each other every morning for quite a while. We get to wish each other a good morning in person everyday, now! The only time we text each other "Good morning" or "Good night" now is when one of us are away.**

```{r, echo = FALSE, fig.height= 10, out.height= "100%", out.width = "100%", warning = FALSE}


 
morn <- texts_combine_filter_graph_groups %>% 
  filter(`Word(s)` == "Good morning")

pmorn <- ggplot(morn, aes(x = week_of, y = `Count of particular word(s) used in our texts`, color = `Word(s)`)) +
  geom_line(linewidth = .6) + 
      scale_color_manual(values = c("#BAC14C", "#EB99F8")) +
  facet_wrap(~title) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") + 
  labs(title = "",
       x = "", color = "&#9644; <b>Word(s)</b><br>&#9670; <b>Milestone</b><br>") +
  theme(
#   strip.background = element_rect(
#     color="#64798B",  linewidth =1, linetype="solid"
#     ),
   strip.text.x = element_text(
        size = 12, color = "black", face = "bold.italic"
        )
   ) +
  geom_point(aes(x = (`Neil moves in`)     , y = 10 , color = "Neil moves in"    ), shape=18, size = 2.5) +
  geom_segment(aes(x=       (`Neil moves in`)            ,         xend=   (`Neil moves in`)         , y=0, yend= 10, color =            "Neil moves in"          ), linewidth = .05)


ggplotly(pmorn) %>% 
  layout(hovermode = 'x') %>% 
  style(hovertext = paste0("Neil moved in with Karina on "                                     , format(as_date(`Neil moves in`), "%b %d, %Y"), ".")                                                                                   , traces = 3:4 ) %>% 
style(hoverinfo = "none", traces = 5:6)

```

<sup>*Click on the chart legend to show/hide any milestones or trends.*</sup>

##### All<br>Words {.tabset .tabset-fade .tabset-pills}

```{r, echo = FALSE, fig.height= 10, out.height= "100%", out.width = "100%", warning = FALSE}

  

pbabe <- ggplot(texts_combine_filter_graph_groups, aes(x = week_of, y = `Count of particular word(s) used in our texts`, color = `Word(s)`)) +
  geom_line(linewidth = .6) + 
  facet_wrap(~title) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") + 
  labs(title = "",
       x = "", color = "&#9644; <b>Word(s)</b><br>&#9670; <b>Milestone</b><br>") +
  theme(
#   strip.background = element_rect(
#     color="#64798B",  linewidth =1, linetype="solid"
#     ),
   strip.text.x = element_text(
        size = 12, color = "black", face = "bold.italic"
        )
   ) +
  geom_point(aes(x = (`First Kiss`)     , y = 140 , color = "First Kiss"      ), shape=18, size = 2.5) +
  geom_point(aes(x = (`New York`)       , y = 140 , color = "New York"        ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Snowboarding`)   , y = 140 , color = "Snowboarding"    ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Meet Parents`)   , y = 140 , color = "Meet Parents"    ), shape=18, size = 2.5) +
  geom_point(aes(x = (Relationship)     , y = 140 , color = "Relationship"    ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Neil Meets Ben`) , y = 140 , color = "Neil Meets Ben"  ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Build Furniture`), y = 140 , color = "Build Furniture" ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Duck Fence`)     , y = 140 , color = "Duck Fence"      ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Chicago`)        , y = 140 , color = "Chicago"         ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Duck Pond`)      , y = 140 , color = "Duck Pond"       ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Dirt Bikes`)     , y = 140 , color = "Dirt Bikes"      ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Neil moves in` ) , y = 140 , color = "Neil moves in"   ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Scuba Diving` )  , y = 140 , color = "Scuba Diving"    ), shape=18, size = 2.5) +
  geom_point(aes(x = (`We Get Engaged!`), y = 140 , color = "We Get Engaged!" ), shape=18, size = 2.5) +   
  geom_point(aes(x = (`Tahiti Trip`)    , y = 140 , color = "Tahiti Trip"     ), shape=18, size = 2.5) +
  geom_point(aes(x = (`We Buy Property`), y = 140 , color = "We Buy Property" ), shape=18, size = 2.5) +
  
  
  geom_segment(aes(x=       (`First Kiss`)            ,         xend=   (`First Kiss`)         , y=0, yend= 140 , color =            "First Kiss"            ), linewidth = .05) +
  geom_segment(aes(x=       (`New York`)              ,         xend=   (`New York`)           , y=0, yend= 140 , color =            "New York"              ), linewidth = .05) +
  geom_segment(aes(x=       (`Snowboarding`)          ,         xend=   (`Snowboarding`)       , y=0, yend= 140 , color =            "Snowboarding"          ), linewidth = .05) +
  geom_segment(aes(x=       (`Meet Parents`)          ,         xend=   (`Meet Parents`)       , y=0, yend= 140 , color =            "Meet Parents"          ), linewidth = .05) +
  geom_segment(aes(x=       (Relationship)            ,         xend=   (Relationship)         , y=0, yend= 140 , color =            "Relationship"          ), linewidth = .05) +
  geom_segment(aes(x=       (`Neil Meets Ben`)        ,         xend=   (`Neil Meets Ben`)     , y=0, yend= 140 , color =            "Neil Meets Ben"        ), linewidth = .05) +
  geom_segment(aes(x=       (`Build Furniture`)       ,         xend=   (`Build Furniture`)    , y=0, yend= 140 , color =            "Build Furniture"       ), linewidth = .05) +
  geom_segment(aes(x=       (`Duck Fence`)            ,         xend=   (`Duck Fence`)         , y=0, yend= 140 , color =            "Duck Fence"            ), linewidth = .05) +
  geom_segment(aes(x=       (`Chicago`)               ,         xend=   (`Chicago`)            , y=0, yend= 140 , color =            "Chicago"               ), linewidth = .05) +
  geom_segment(aes(x=       (`Duck Pond`)             ,         xend=   (`Duck Pond`)          , y=0, yend= 140 , color =            "Duck Pond"             ), linewidth = .05) +
  geom_segment(aes(x=       (`Dirt Bikes`)            ,         xend=   (`Dirt Bikes`)         , y=0, yend= 140 , color =            "Dirt Bikes"            ), linewidth = .05) +
  geom_segment(aes(x=       (`Neil moves in` )        ,         xend=   (`Neil moves in` )     , y=0, yend= 140 , color =            "Neil moves in"         ), linewidth = .05) +
  geom_segment(aes(x=       (`Scuba Diving` )         ,         xend=   (`Scuba Diving` )      , y=0, yend= 140 , color =            "Scuba Diving"          ), linewidth = .05) +
  geom_segment(aes(x=       (`We Get Engaged!`)       ,         xend=   (`We Get Engaged!`)    , y=0, yend= 140 , color =            "We Get Engaged!"       ), linewidth = .05) +
  geom_segment(aes(x=       (`Tahiti Trip`)           ,         xend=   (`Tahiti Trip`)        , y=0, yend= 140 , color =            "Tahiti Trip"           ), linewidth = .05) +
  geom_segment(aes(x=       (`We Buy Property`)       ,         xend=   (`We Buy Property`)    , y=0, yend= 140 , color =            "We Buy Property"       ), linewidth = .05) 

ggplotly(pbabe) %>% 
#  layout(hovermode = 'x') %>%
 # style(visible='legendonly', traces = 1:2 )   %>% 
 #style(visible='legendonly',  traces = 2:3)   %>% 
  
  
  style(hovertext = paste0("Our first kiss was on "                                            , format(as_date(`First Kiss`), "%b %d, %Y"), "!")                                                                                      , traces = 17:18  ) %>% 
  style(hovertext = paste0("We take our first trip to New York together on "                   , format(as_date(`New York`), "%b %d, %Y"), ".\nThis is also the first time Neil met Karina's parents.")                               , traces = 19:20  ) %>% 
  style(hovertext = paste0("Our first time ever snowboarding together was on "                 , format(as_date(`Snowboarding`), "%b %d, %Y"), ".\nNeil proved he can shred to Karina!")                                              , traces = 21:22  ) %>% 
  style(hovertext = paste0("Karina flies to Alpine, CA to meet Neil's parents on "             , format(as_date(`Meet Parents`), "%b %d, %Y"), ".\nWe played card games all New Years Eve and kissed at midnight!")                   , traces = 23:24  ) %>% 
  style(hovertext = paste0("We make it official, we decide we want to be in a relationship on" , format(as_date(Relationship), "%b %d, %Y"), '.\nWe also said "I love you" in person for the first time on this day.')                , traces = 25:26  ) %>% 
  style(hovertext = paste0("We go snowboarding with Karina's son, Ben, on "                   , format(as_date(`Neil Meets Ben`), "%b %d, %Y"), ".\nIt's the first time Neil met Ben.")                                                , traces = 27:28  ) %>% 
  style(hovertext = paste0("We build our first piece of IKEA furniture together on "           , format(as_date(`Build Furniture`), "%b %d, %Y"), ".\nSafe to say we didn't fight while building it.")                                         , traces = 29:30  ) %>% 
  style(hovertext = paste0("We built a duck fence on "                                         , format(as_date(`Duck Fence`), "%b %d, %Y"), ".\nOur first outside project!")                                                           , traces = 31:32 ) %>% 
  style(hovertext = paste0("We take a trip to Chicago on "                                     , format(as_date(`Chicago`), "%b %d, %Y"), ".\nNeil got to meet some of Karina's grad school peers.")                                    , traces = 33:34 ) %>% 
  style(hovertext = paste0("We built a duck pond on "                                          , format(as_date(`Duck Pond`), "%b %d, %Y"), ".\nA continuation of the duck fence project.")                                             , traces = 35:36 ) %>% 
  style(hovertext = paste0("We bought our dirt bikes on "                                      , format(as_date(`Dirt Bikes`), "%b %d, %Y"), ".\nWe each have a Yamaha TTR230 and we love them!")                                       , traces = 37:38 ) %>% 
  style(hovertext = paste0("Neil moved in with Karina on "                                     , format(as_date(`Neil moves in`), "%b %d, %Y"), ".")                                                                                   , traces = 39:40 ) %>% 
  style(hovertext = paste0("We go scuba diving for the first time in Key Largo, FL on "        , format(as_date(`Scuba Diving`), "%b %d, %Y"), "!")                                                                                    , traces = 41:42 ) %>%
  style(hovertext = paste0("We got engaged on "                                                , format(as_date(`We Get Engaged!`), "%b %d, %Y"), "!\nNeil hired a photographer to capture the moment at Mt. Hood Meadows ski resort.") , traces = 43:44 ) %>%
  style(hovertext = paste0("We take our first trip as an engaged couple to Tahiti on"          , format(as_date(`Tahiti Trip`), "%b %d, %Y"), ".\nWe sailed on a Yacht to different islands for 10 days!")                               , traces = 45:46 ) %>% 
  style(hovertext = paste0("We bought a 1 acre piece of land in La Pine, OR on "               , format(as_date(`We Buy Property`), "%b %d, %Y"), ".\nOur plan is to build a getaway cabin on the land!")                               , traces = 47:48 ) %>% 
  style(hoverinfo = "none", traces = 49:80) 
```

<sup>*Click on the chart legend to show/hide any milestones or trends.*</sup>

##### Combined<br>Data {.tabset .tabset-fade .tabset-pills}

```{r, out.height= "100%", out.width = "100%", echo = FALSE, warning = FALSE}
pall <- line_plots_words(texts_combine_filter_graph_total, x = week_of, y = `Count of particular word(s) used in our texts`); 
hover_range_words(pall)
```

<sup>*Click on the chart legend to show/hide any milestones or trends.*</sup>

## Travel<br>Data {.tabset .tabset-fade .tabset-pills}

**A collage of us together on some of our favorite trips!**

<center><img src="collage.png" width="100%"/></center>

<br>

**A Map of the places we have traveled together!**

```{r, out.height= "100%", out.width = "100%", echo = FALSE, eval=TRUE}


travel <- suppress(read_csv("travel_neil.csv"))

travel <- travel %>% 
  mutate(date = ifelse(is.na(date), "...", date)) %>% 
  mutate(info = paste0(place, "<br>", country, ifelse(country == "USA", ", ", ""), ifelse(!is.na(state), state, ""), "<br>", "We last visited ", place, " on ", date, "<br>", describe))
  
register_google(key = private_key, account_type = "standard")


map <- google_map(
  key = private_key,
  data = travel, 
  search_box = FALSE,
  width = 900,
  height = 512
)

map %>%
  googleway::add_markers(lat = "lat", lon = "lon",  mouse_over = "info")
```

<sup>*Hover over the markers to get information and see when we last visited each place!*</sup>

## Snowboarding<br>Data {.tabset .tabset-fade .tabset-pills}

<center><img src="nkmeadows.png" width="200%"/></center>

**Snowboarding is one of our favorite hobbies. Thanks to Mt. Hood Meadows for our snowboarding data!**

<br>

In the first tab, we display the runs at our local ski resort, Mt. Hood Meadows ski resort. In the next tab we wanted to show everyone how often we like to snowboard, using the data we get from our annual ski passes.

<br>

*Take a look at the charts of our snowboarding data in the tabs below!*



### Chairlift<br>Data {.tabset .tabset-fade .tabset-pills}

#### Over Time {.tabset .tabset-fade .tabset-pills}

**On our busiest days, we achieved a 15,000+ vertical!**

**By Vertical Feet Gained**

```{r, echo = FALSE,  out.height= "100%", out.width = "100%"}

vertical_feet <- ggplot(hood_vert_graph, aes(x = Date, y =  `Vertical Ft. Gained`, color = Season)) +
  geom_point(size = 3) +
  geom_segment(aes(x=Date, xend=Date, y=0, yend= `Vertical Ft. Gained`)) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
    scale_x_date(date_labels="%b %Y",date_breaks  ="1 month", expand = c(.4,0,.1,0)) +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  labs(title = "",
       x = "") +
  facet_wrap(~Season, scales = "free_x") +
  theme(legend.position="none")


ggplotly(vertical_feet) %>% 
  layout(hovermode = 'x') %>% 
  style(hoverinfo = "none", traces = 3:4)

```

<sup>*Hover over each dot to see how much vertical feet we gained on each date we snowboarded at Mt. Hood Meadows ski resort.*</sup>

**We seem to tap out around 15 runs in a day...**

**By number of Runs Completed**

```{r, echo = FALSE,  out.height= "100%", out.width = "100%"}

total_runs <- ggplot(hood_runs_graph, aes(x = Date, y =  `Total Runs`, color = Season)) +
  geom_point(size = 3) +
  geom_segment(aes(x=Date, xend=Date, y=0, yend= `Total Runs`)) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  labs(title = "",
       x = "") +
  facet_wrap(~Season, scales = "free_x") +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month", expand = c(.4,0,.1,0)) +
  theme(legend.position="none")

  
ggplotly(total_runs) %>% 
  layout(hovermode = 'x')  %>% 
  style(hoverinfo = "none", traces = 3:4)

```

<sup>*Hover over each dot to see how many times we took the ski lift on each date we snowboarded at Mt. Hood Meadows ski resort.*</sup>




#### Overall {.tabset .tabset-fade .tabset-pills}

Each box below represents the amount we used the ski lifts at Mt. Hood Meadows ski resort.

**Mt. Hood Express gets us the most elevation gain.**

**In vertical feet gained**

```{r, echo = FALSE,  out.height= "100%", out.width = "100%"}
hood_runs_tree <- hood_runs_tree %>% 
  arrange(Runs)

plot_ly(
  hood_runs_tree,
  labels = ~ Runs,
  parents = NA,
  values = ~ `Vertical Ft. Gained`,
  type = 'treemap',
  marker=list(colors=col[["name"]]),
  marker = list(`Runs` = ~`Runs`),
  hovertemplate = "Chair lift: %{label}<br>We've ridden up %{value} ft. on %{label}!<extra></extra>"
) %>% 
  layout(title= list(text = ""))

```

<sup>*Hover over each box to see how much vertical feet we have gained on each chairlift at Mt. Hood Meadows ski resort!*</sup>

**But we are not ashamed to take Easy Rider to get us to our favorite beginners Freestyle Park!**

**By number of runs**

```{r, echo = FALSE,  out.height= "100%", out.width = "100%"}

plot_ly(
  hood_runs_tree,
  labels = ~Runs,
  parents = NA,
  values = ~ `Total Runs`,
  type = 'treemap',
  marker=list(colors=col[["name"]]),
  marker = list(`Runs` = ~`Runs`),
  hovertemplate = "Chair lift: %{label}<br>We've ridden %{label} %{value} times!<extra></extra>"
) %>% 
  layout(title= list(text = ""))

```

<sup>*Hover over each box to see how many times we have taken each chairlift at Mt. Hood Meadows ski resort!*</sup>


### Mt. Hood Meadows Ski Resort {.tabset .tabset-fade .tabset-pills}

**Mt. Hood Meadows Ski Resort Runs on Google Maps.**

```{r,  out.height= "75%", out.width = "75%", echo = FALSE, eval=TRUE}

mt_hood <- google_map(
  key = private_key,
  data = travel, 
  search_box = FALSE,
  width = 1000,
  height = 600, 
  location = c(45.3390, -121.6652), 
  zoom = 14#,
#  map_type = "hybrid"
) 

mt_hood %>% 
  googleway::add_markers(lat = 45.34802365909766, lon = -121.65863752775641, mouse_over = "This is where we got engaged! <br>Right in front of a waterfall in Heather Canyon!", update_map_view = FALSE)
```

<sup>*Hover over the marker to see where we got engaged!*</sup>

**Mt. Hood Trail Map**

Take a look at how awesome our local ski resort is. We love Mt. Hood Meadows!

<center><img src="meadow_map.jpg" width="100%"/></center>

## Discretionary<br>Spending {.tabset .tabset-fade .tabset-pills}

**Each box below corresponds to a percentage of our disposable income spent on a given category (i.e. this excludes boring spending like mortgage, utilities, student loans, or car payments). We analyzed our spending habits over the course of our relationship.** <br>



<sup>*Hover over each box to see what percentage we spend on each category*</sup>

### Our Individual Spending Habits {.tabset .tabset-fade .tabset-pills}

**Karina likes to buy things and and stay at AirBNBs. Activities and subscriptions also add up quite a bit.**

<br>

**Karina's Spending**

```{r, message = FALSE, warning = FALSE, echo = FALSE, out.height= "100%", out.width = "100%" }
Karina_fig <- plot_ly(
  finance_summ_Karina,
  labels = ~`Proposed Category`,
  parents = NA,
  values = ~ Amount,
  type = 'treemap',
   marker=list(colors=col[["name"]]),
  marker = list(`Proposed Category` = ~`Proposed Category`),
  hovertemplate = "%{value}% of Karina's spending is on %{label}.<extra></extra>"
) 

Karina_fig
```

<sup>*Hover over each box to see what percentage Karina spends on each category.*</sup>

<br>

**Neil like Bars & Restaurants. Makes sense, he loves to eat and drink! Some notable mentions include Pet Expenses, Snowboarding Gear, and Concerts!**

<br>

**Neil's Spending**

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}

Neil_fig <- plot_ly(
  finance_summ_Neil,
  labels = ~`Proposed Category`,
  parents = NA,
  values = ~Amount,
  type = 'treemap',
 # color = ~`Proposed Category`,
  marker=list(colors=col[["name"]]),
 # marker = list(`Proposed Category` = ~`Proposed Category`),
  hovertemplate = "%{value}% of Neil's spending is on %{label}.<extra></extra>"
) 


Neil_fig
```

<sup>*Hover over each box to see what percentage Neil spends on each category.*</sup>

### Our Overall Spending Habits {.tabset .tabset-fade .tabset-pills}

**Besides the obvious Bars & Restaurants and Amazon spending, we were surprised to see how much we spent on Chipotle and Golf!**

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%" }


plot_ly(
  finance_summ,
  labels = ~`Proposed Category`,
  parents = NA,
  values = ~ Amount,
  type = 'treemap',
   marker=list(colors=col[["name"]]),
  marker = list(`Proposed Category` = ~`Proposed Category`),
  hovertemplate = "%{value}% of our spending is on %{label}.<extra></extra>"
) %>% 
  layout(title= list(text = ""))

```

## Market<br>Comparisons {.tabset .tabset-fade .tabset-pills}

**Since we first met, the S&P 500 has gone up dramatically! We decided to examine if our relationship milestones or other relationship data could be responsible.**

<br>

At first glance, an obvious takeaway is that the market went up over the course of our relationship. There might be something else going on here that we dive into in the next tab. But for now, enjoy how our relationship impacted the market!

<br>

**The S&P 500 & our milestones**

```{r, echo = FALSE,  out.height= "100%", out.width = "100%", warning = FALSE}
sp500 <- macro_data$`S&P 500`


sp500 <- sp500 %>% 
  mutate(Date = as_date(Date)) %>% 
  select(Date, `Close/Last`) %>% 
  mutate(source = "S&P 500")


sp500_graph <- ggplot(sp500, aes(x = Date, y = `Close/Last`) )+
 geom_line(linewidth = .6) + 
#  scale_y_continuous("S&P500", sec.axis = sec_axis(~(.), name = "Dow Jones"), limits = c(3500, max(sp500$`Close`)), , expand = c(0, 0, .14, 0)) +
  theme_classic() +
  scale_y_continuous(limits = c(3500, max(sp500$`Close/Last`)), expand = c(0, 0, .14, 0)) +
  labs(title="", x="", color = "&#9644; <b>Close Price</b><br>&#9670; <b>Milestone</b><br>") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") +

  geom_point(aes(x = (`Tinder Match`)   , y = max(`Close/Last`) , color = "Tinder Match"    ), shape=18, size = 4) +    
  geom_point(aes(x = (`First Kiss`)     , y = max(`Close/Last`) , color = "First Kiss"      ), shape=18, size = 4) +
  geom_point(aes(x = (`New York`)       , y = max(`Close/Last`) , color = "New York"        ), shape=18, size = 4) +
  geom_point(aes(x = (`Snowboarding`)   , y = max(`Close/Last`) , color = "Snowboarding"    ), shape=18, size = 4) +
  geom_point(aes(x = (`Meet Parents`)   , y = max(`Close/Last`) , color = "Meet Parents"    ), shape=18, size = 4) +
  geom_point(aes(x = (Relationship)     , y = max(`Close/Last`) , color = "Relationship"    ), shape=18, size = 4) +
  geom_point(aes(x = (`Neil Meets Ben`) , y = max(`Close/Last`) , color = "Neil Meets Ben"  ), shape=18, size = 4) +
  geom_point(aes(x = (`Build Furniture`), y = max(`Close/Last`) , color = "Build Furniture" ), shape=18, size = 4) +
  geom_point(aes(x = (`Duck Fence`)     , y = max(`Close/Last`) , color = "Duck Fence"      ), shape=18, size = 4) +
  geom_point(aes(x = (`Chicago`)        , y = max(`Close/Last`) , color = "Chicago"         ), shape=18, size = 4) +
  geom_point(aes(x = (`Duck Pond`)      , y = max(`Close/Last`) , color = "Duck Pond"       ), shape=18, size = 4) +
  geom_point(aes(x = (`Dirt Bikes`)     , y = max(`Close/Last`) , color = "Dirt Bikes"      ), shape=18, size = 4) +
  geom_point(aes(x = (`Neil moves in` ) , y = max(`Close/Last`) , color = "Neil moves in"   ), shape=18, size = 4) +
  geom_point(aes(x = (`Scuba Diving` )  , y = max(`Close/Last`) , color = "Scuba Diving"    ), shape=18, size = 4) +
  geom_point(aes(x = (`We Get Engaged!`), y = max(`Close/Last`) , color = "We Get Engaged!" ), shape=18, size = 4) +   
  geom_point(aes(x = (`Tahiti Trip`)    , y = max(`Close/Last`) , color = "Tahiti Trip"     ), shape=18, size = 4) +
  geom_point(aes(x = (`We Buy Property`), y = max(`Close/Last`) , color = "We Buy Property" ), shape=18, size = 4) +
  
  
  geom_segment(aes(x=       (`Tinder Match`)            ,       xend=   (`Tinder Match`)                        , y=3500, yend= `Close/Last` , color =                          "Tinder Match"                        ), linewidth = .05) +
  geom_segment(aes(x=       (`First Kiss`)            ,         xend=   (`First Kiss`)                          , y=3500, yend= `Close/Last` , color =                            "First Kiss"                        ), linewidth = .05) +
  geom_segment(aes(x=       (`New York`)              ,         xend=   (`New York`)                            , y=3500, yend= `Close/Last` , color =                             "New York"                         ), linewidth = .05) +
  geom_segment(aes(x=       (`Snowboarding`)          ,         xend=   (`Snowboarding`)                        , y=3500, yend= `Close/Last` , color =                            "Snowboarding"                      ), linewidth = .05) +
  geom_segment(aes(x=       (`Meet Parents`)          ,         xend=   (`Meet Parents`)                        , y=3500, yend= `Close/Last` , color =                            "Meet Parents"                      ), linewidth = .05) +
  geom_segment(aes(x=       (Relationship)            ,         xend=   (Relationship)                          , y=3500, yend= `Close/Last` , color =                            "Relationship"                      ), linewidth = .05) +
  geom_segment(aes(x=       (`Neil Meets Ben`)        ,         xend=   (`Neil Meets Ben`)                      , y=3500, yend= `Close/Last` , color =                            "Neil Meets Ben"                    ), linewidth = .05) +
  geom_segment(aes(x=       (`Build Furniture`)       ,         xend=   (`Build Furniture`)                     , y=3500, yend= `Close/Last` , color =                            "Build Furniture"                   ), linewidth = .05) +
  geom_segment(aes(x=       (`Duck Fence`)            ,         xend=   (`Duck Fence`)                          , y=3500, yend= `Close/Last` , color =                            "Duck Fence"                        ), linewidth = .05) +
  geom_segment(aes(x=       (`Chicago`)               ,         xend=   (`Chicago`)                             , y=3500, yend= `Close/Last` , color =                            "Chicago"                           ), linewidth = .05) +
  geom_segment(aes(x=       (`Duck Pond`)             ,         xend=   (`Duck Pond`)                           , y=3500, yend= `Close/Last` , color =                            "Duck Pond"                         ), linewidth = .05) +
  geom_segment(aes(x=       (`Dirt Bikes`)            ,         xend=   (`Dirt Bikes`)                          , y=3500, yend= `Close/Last` , color =                            "Dirt Bikes"                        ), linewidth = .05) +
  geom_segment(aes(x=       (`Neil moves in` )        ,         xend=   (`Neil moves in` )                      , y=3500, yend= `Close/Last` , color =                            "Neil moves in"                     ), linewidth = .05) +
  geom_segment(aes(x=       (`Scuba Diving` )         ,         xend=   (`Scuba Diving` )                       , y=3500, yend= `Close/Last` , color =                            "Scuba Diving"                      ), linewidth = .05) +
  geom_segment(aes(x=       (`We Get Engaged!`)       ,         xend=   (`We Get Engaged!`)                     , y=3500, yend= `Close/Last` , color =                            "We Get Engaged!"                   ), linewidth = .05) +
  geom_segment(aes(x=       (`Tahiti Trip`)           ,         xend=   (`Tahiti Trip`)                         , y=3500, yend= `Close/Last` , color =                            "Tahiti Trip"                       ), linewidth = .05) +
  geom_segment(aes(x=       (`We Buy Property`)       ,         xend=   (`We Buy Property`)                     , y=3500, yend= `Close/Last` , color =                            "We Buy Property"                   ), linewidth = .05) 
  


ggplotly(sp500_graph) %>% 
 # layout(hovermode = 'x') %>%
  style(hovertext = paste0("We matched on Tinder on "                                          , format(as_date(`Tinder Match`), "%b %d, %Y"), "!")                                                                                      , traces = 2  ) %>% 
  style(hovertext = paste0("Our first kiss was on "                                            , format(as_date(`First Kiss`), "%b %d, %Y"), "!")                                                                                      , traces = 3  ) %>% 
  style(hovertext = paste0("We take our first trip to New York together on "                   , format(as_date(`New York`), "%b %d, %Y"), ".\nThis is also the first time Neil Met Karina's parents.")                               , traces = 4  ) %>% 
  style(hovertext = paste0("Our first time ever snowboarding together was on "                 , format(as_date(`Snowboarding`), "%b %d, %Y"), ".\nNeil proved he can shred to Karina!")                                              , traces = 5  ) %>% 
  style(hovertext = paste0("Karina flies to Alpine, CA to meet Neil's parents on "             , format(as_date(`Meet Parents`), "%b %d, %Y"), ".\nWe played card games all New Years Eve and kissed at midnight!")                   , traces = 6  ) %>% 
  style(hovertext = paste0("We make it official, we decide we want to be in a relationship on " , format(as_date(Relationship), "%b %d, %Y"), '.\nWe also said "I love you" in person for the first time on this day.')                , traces = 7  ) %>% 
  style(hovertext = paste0("We go snow boarding with Karina's son, Ben, on "                   , format(as_date(`Neil Meets Ben`), "%b %d, %Y"), ".\nIt's the first time Neil met Ben.")                                                , traces = 8  ) %>% 
  style(hovertext = paste0("We build our first piece of IKEA furniture together on "           , format(as_date(`Build Furniture`), "%b %d, %Y"), ".\nSafe to say we didn't fight while building it.")                                         , traces = 9  ) %>% 
  style(hovertext = paste0("We built a duck fence on "                                         , format(as_date(`Duck Fence`), "%b %d, %Y"), ".\nOur first outside project!")                                                           , traces = 10 ) %>% 
  style(hovertext = paste0("We take a trip to Chicago on "                                     , format(as_date(`Chicago`), "%b %d, %Y"), ".\nNeil got to meet some of Karina's grad school peers.")                                    , traces = 11 ) %>% 
  style(hovertext = paste0("We built a duck pond on "                                          , format(as_date(`Duck Pond`), "%b %d, %Y"), ".\nA continuation of the duck fence project.")                                             , traces =  12) %>% 
  style(hovertext = paste0("We bought our dirt bikes on "                                      , format(as_date(`Dirt Bikes`), "%b %d, %Y"), ".\nWe each have a Yamaha TTR230 and we love them!")                                       , traces =  13) %>% 
  style(hovertext = paste0("Neil moved in with Karina on "                                     , format(as_date(`Neil moves in`), "%b %d, %Y"), ".")                                                                                   , traces =  14) %>% 
  style(hovertext = paste0("We go scuba diving for the first time in Key Largo, FL on "        , format(as_date(`Scuba Diving`), "%b %d, %Y"), "!")                                                                                    , traces =  15) %>%
  style(hovertext = paste0("We got engaged on "                                                , format(as_date(`We Get Engaged!`), "%b %d, %Y"), "!\nNeil hired a photographer to capture the moment at Mt. Hood Meadows ski resort.") , traces = 16 ) %>%
  style(hovertext = paste0("We take our first trip as an engaged couple to Tahiti on "          , format(as_date(`Tahiti Trip`), "%b %d, %Y"), ".\nWe sailed on a Yacht to different islands for 10 days!")                               , traces =  17) %>% 
  style(hovertext = paste0("We bought a 1 acre piece of land in La Pine, OR on "               , format(as_date(`We Buy Property`), "%b %d, %Y"), ".\nOur plan is to build a getaway cabin on the land!")                               , traces =  18) %>% 
  style(hoverinfo = "none", traces = 19:35)

```

<sup>*Hover over the chart and milestones for more information about our milestones and the market price. Or click on the chart legend to show/hide any Milestones.*</sup>

```{r, echo = FALSE,  out.height= "100%", out.width = "100%", warning = FALSE, eval = FALSE}

##**The Dow Jones & our Milestones**
#
#dowjones <- macro_data$`Dow Jones`
#
#dowjones <- dowjones %>% 
#  mutate(Date = as_date(Date)) %>% 
#  filter(Date < "2024-8-22") %>% 
#  select(Date, `Close/Last` = "Close") %>% 
#  mutate(source = "Dow Jones") 
#
#
#dowjones_graph <- ggplot(dowjones, aes(x = Date, y = `Close/Last`) )+
# geom_line(linewidth = .6) + 
##  scale_y_continuous("S&P500", sec.axis = sec_axis(~(.), name = "Dow Jones"), limits = c(3500, max(sp500$`Close`)), , expand = c(0, 0, .14, 0)) +
#  theme_classic() +
#  scale_y_continuous(limits = c(27000, max(dowjones$`Close/Last`)), expand = c(0, 0, .14, 0)) +
#  labs(title="", x="", color = "&#9644; <b>Close Price</b><br>&#9670; <b>Milestone</b><br>") +
#  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
#  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") +
#
#  geom_point(aes(x = (`Tinder Match`)   , y = max(`Close/Last`) , color = "Tinder Match"    ), shape=18, size = 4) +    
#  geom_point(aes(x = (`First Kiss`)     , y = max(`Close/Last`) , color = "First Kiss"      ), shape=18, size = 4) +
#  geom_point(aes(x = (`New York`)       , y = max(`Close/Last`) , color = "New York"        ), shape=18, size = 4) +
#  geom_point(aes(x = (`Snowboarding`)   , y = max(`Close/Last`) , color = "Snowboarding"    ), shape=18, size = 4) +
#  geom_point(aes(x = (`Meet Parents`)   , y = max(`Close/Last`) , color = "Meet Parents"    ), shape=18, size = 4) +
#  geom_point(aes(x = (Relationship)     , y = max(`Close/Last`) , color = "Relationship"    ), shape=18, size = 4) +
#  geom_point(aes(x = (`Neil Meets Ben`) , y = max(`Close/Last`) , color = "Neil Meets Ben"  ), shape=18, size = 4) +
#  geom_point(aes(x = (`Build Furniture`), y = max(`Close/Last`) , color = "Build Furniture" ), shape=18, size = 4) +
#  geom_point(aes(x = (`Duck Fence`)     , y = max(`Close/Last`) , color = "Duck Fence"      ), shape=18, size = 4) +
#  geom_point(aes(x = (`Chicago`)        , y = max(`Close/Last`) , color = "Chicago"         ), shape=18, size = 4) +
#  geom_point(aes(x = (`Duck Pond`)      , y = max(`Close/Last`) , color = "Duck Pond"       ), shape=18, size = 4) +
#  geom_point(aes(x = (`Dirt Bikes`)     , y = max(`Close/Last`) , color = "Dirt Bikes"      ), shape=18, size = 4) +
#  geom_point(aes(x = (`Neil moves in` ) , y = max(`Close/Last`) , color = "Neil moves in"   ), shape=18, size = 4) +
#  geom_point(aes(x = (`Scuba Diving` )  , y = max(`Close/Last`) , color = "Scuba Diving"    ), shape=18, size = 4) +
#  geom_point(aes(x = (`We Get Engaged!`), y = max(`Close/Last`) , color = "We Get Engaged!" ), shape=18, size = 4) +   
#  geom_point(aes(x = (`Tahiti Trip`)    , y = max(`Close/Last`) , color = "Tahiti Trip"     ), shape=18, size = 4) +
#  geom_point(aes(x = (`We Buy Property`), y = max(`Close/Last`) , color = "We Buy Property" ), shape=18, size = 4) +
#  
#  
#  geom_segment(aes(x=       (`Tinder Match`)            ,       xend=   (`Tinder Match`)                        , y=27000, yend= `Close/Last` , color =                          "Tinder Match"              #          ), linewidth = .05) +
#  geom_segment(aes(x=       (`First Kiss`)            ,         xend=   (`First Kiss`)                          , y=27000, yend= `Close/Last` , color =                            "First Kiss"              #          ), linewidth = .05) +
#  geom_segment(aes(x=       (`New York`)              ,         xend=   (`New York`)                            , y=27000, yend= `Close/Last` , color =                             "New York"               #          ), linewidth = .05) +
#  geom_segment(aes(x=       (`Snowboarding`)          ,         xend=   (`Snowboarding`)                        , y=27000, yend= `Close/Last` , color =                            "Snowboarding"            #          ), linewidth = .05) +
#  geom_segment(aes(x=       (`Meet Parents`)          ,         xend=   (`Meet Parents`)                        , y=27000, yend= `Close/Last` , color =                            "Meet Parents"            #          ), linewidth = .05) +
#  geom_segment(aes(x=       (Relationship)            ,         xend=   (Relationship)                          , y=27000, yend= `Close/Last` , color =                            "Relationship"            #          ), linewidth = .05) +
#  geom_segment(aes(x=       (`Neil Meets Ben`)        ,         xend=   (`Neil Meets Ben`)                      , y=27000, yend= `Close/Last` , color =                            "Neil Meets Ben"          #          ), linewidth = .05) +
#  geom_segment(aes(x=       (`Build Furniture`)       ,         xend=   (`Build Furniture`)                     , y=27000, yend= `Close/Last` , color =                            "Build Furniture"         #          ), linewidth = .05) +
#  geom_segment(aes(x=       (`Duck Fence`)            ,         xend=   (`Duck Fence`)                          , y=27000, yend= `Close/Last` , color =                            "Duck Fence"              #          ), linewidth = .05) +
#  geom_segment(aes(x=       (`Chicago`)               ,         xend=   (`Chicago`)                             , y=27000, yend= `Close/Last` , color =                            "Chicago"                 #          ), linewidth = .05) +
#  geom_segment(aes(x=       (`Duck Pond`)             ,         xend=   (`Duck Pond`)                           , y=27000, yend= `Close/Last` , color =                            "Duck Pond"               #          ), linewidth = .05) +
#  geom_segment(aes(x=       (`Dirt Bikes`)            ,         xend=   (`Dirt Bikes`)                          , y=27000, yend= `Close/Last` , color =                            "Dirt Bikes"              #          ), linewidth = .05) +
#  geom_segment(aes(x=       (`Neil moves in` )        ,         xend=   (`Neil moves in` )                      , y=27000, yend= `Close/Last` , color =                            "Neil moves in"           #          ), linewidth = .05) +
#  geom_segment(aes(x=       (`Scuba Diving` )         ,         xend=   (`Scuba Diving` )                       , y=27000, yend= `Close/Last` , color =                            "Scuba Diving"            #          ), linewidth = .05) +
#  geom_segment(aes(x=       (`We Get Engaged!`)       ,         xend=   (`We Get Engaged!`)                     , y=27000, yend= `Close/Last` , color =                            "We Get Engaged!"         #          ), linewidth = .05) +
#  geom_segment(aes(x=       (`Tahiti Trip`)           ,         xend=   (`Tahiti Trip`)                         , y=27000, yend= `Close/Last` , color =                            "Tahiti Trip"             #          ), linewidth = .05) +
#  geom_segment(aes(x=       (`We Buy Property`)       ,         xend=   (`We Buy Property`)                     , y=27000, yend= `Close/Last` , color =                            "We Buy Property"         #          ), linewidth = .05) 
#  
#
#
#ggplotly(dowjones_graph) %>% 
##  layout(hovermode = 'x') %>%
#  style(hovertext = paste0("We matched on Tinder on "                                          , format(as_date(`Tinder Match`), "%b %d, %Y"), "!")                                                          #                            , traces = 2  ) %>% 
#  style(hovertext = paste0("Our first kiss was on "                                            , format(as_date(`First Kiss`), "%b %d, %Y"), "!")                                                            #                          , traces = 3  ) %>% 
#  style(hovertext = paste0("We take our first trip to New York together on "                   , format(as_date(`New York`), "%b %d, %Y"), ".\nThis is also the first time Neil Met Karina's parents.")      #                         , traces = 4  ) %>% 
#  style(hovertext = paste0("Our first time ever snowboarding together was on "                 , format(as_date(`Snowboarding`), "%b %d, %Y"), ".\nNeil proved he can shred to Karina!")                     #                         , traces = 5  ) %>% 
#  style(hovertext = paste0("Karina flies to Alpine, CA to meet Neil's parents on "             , format(as_date(`Meet Parents`), "%b %d, %Y"), ".\nWe played card games all New Years Eve and kissed at #midnight!")                   , traces = 6  ) %>% 
#  style(hovertext = paste0("We make it official, we decide we want to be in a relationship on " , format(as_date(Relationship), "%b %d, %Y"), '.\nWe also said "I love you" in person for the first time on #this day.')                , traces = 7  ) %>% 
#  style(hovertext = paste0("We go snow boarding with Karina's son, Ben, on "                   , format(as_date(`Neil Meets Ben`), "%b %d, %Y"), ".\nIt's the first time Neil met Ben.")                     #                           , traces = 8  ) %>% 
#  style(hovertext = paste0("We build our first piece of IKEA furniture together on "           , format(as_date(`Build Furniture`), "%b %d, %Y"), ".\nSafe to say we didn't fight while building it.")       #                                  , traces = 9  ) %>% 
#  style(hovertext = paste0("We built a duck fence on "                                         , format(as_date(`Duck Fence`), "%b %d, %Y"), ".\nOur first outside project!")                                #                           , traces = 10 ) %>% 
#  style(hovertext = paste0("We take a trip to Chicago on "                                     , format(as_date(`Chicago`), "%b %d, %Y"), ".\nNeil got to meet some of Karina's grad school peers.")         #                           , traces = 11 ) %>% 
#  style(hovertext = paste0("We built a duck pond on "                                          , format(as_date(`Duck Pond`), "%b %d, %Y"), ".\nA continuation of the duck fence project.")                  #                           , traces =  12) %>% 
#  style(hovertext = paste0("We bought our dirt bikes on "                                      , format(as_date(`Dirt Bikes`), "%b %d, %Y"), ".\nWe each have a Yamaha TTR230 and we love them!")            #                           , traces =  13) %>% 
#  style(hovertext = paste0("Neil moved in with Karina on "                                     , format(as_date(`Neil moves in`), "%b %d, %Y"), ".")                                                         #                          , traces =  14) %>% 
#  style(hovertext = paste0("We go scuba diving for the first time in Key Largo, FL on "        , format(as_date(`Scuba Diving`), "%b %d, %Y"), "!")                                                          #                          , traces =  15) %>%
#  style(hovertext = paste0("We got engaged on "                                                , format(as_date(`We Get Engaged!`), "%b %d, %Y"), "!\nNeil hired a photographer to capture the moment at Mt. #Hood Meadows ski resort.") , traces = 16 ) %>%
#  style(hovertext = paste0("We take our first trip as an engaged couple to Tahiti on "          , format(as_date(`Tahiti Trip`), "%b %d, %Y"), ".\nWe sailed on a Yacht to different islands for 10 days!")  #                             , traces =  17) %>% 
#  style(hovertext = paste0("We bought a 1 acre piece of land in La Pine, OR on "               , format(as_date(`We Buy Property`), "%b %d, %Y"), ".\nOur plan is to build a getaway cabin on the land!")    #                           , traces =  18) %>% 
#  style(hoverinfo = "none", traces = 19:35)
#
##<sup>*Hover over the chart and milestones for more information about our milestones and the market price. Or click on the chart legend to show/hide any Milestones.*</sup>
#
```


## Deeper<br>Dive {.tabset .tabset-fade .tabset-pills}

So how do we explain why our relationship had such a positive impact on the market? We took some liberties with analytical tools at our disposal to try to logically explain it.

### Market Predictions & Texting {.tabset .tabset-fade .tabset-pills}

**We decided to see if our texting data is predictive of the market.**

<br>

**According to the models in the table below, when correlated to the closing daily values of the S&P 500 (controlling for time), our texting is predictive of the change in the absolute market price. The relationship is positive and statistically significant and our impact on the absolute market changes over time.**

<br>

**However, when compared to the daily movements in the S&P 500 index (controlling for time), our models were no longer predictive... :(**

<br>

<sup>Note: These models are completely for fun and should *not* be taken seriously. :)</sup>

<br>

**Model Descriptives**

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}


reg_table_in <- numdffinal_in %>% 
  left_join(estimatefinal_in, by = "name") %>% 
  left_join(estimatefinal_in2, by = "name") %>% 
  left_join(estimatefinal_in3, by = "name") %>% 
  left_join(dendffinal_in   , by = "name") %>% 
  left_join(ffinal_in       , by = "name") %>% 
  left_join(pvalfinal_in    , by = "name") %>% 
  left_join(r2final_in      , by = "name") %>% 
  mutate(`Degrees of Freedom` = paste0("(", `Numerator DF`, ", " , `Denominator DF`, ")")) %>% 
  select(`Market Name` = "name", `Unstandardized Beta (texts)`, `Unstandardized Beta (time)`,  `Unstandardized Beta (texts*time)`,  `Degrees of Freedom`, `F-value`, `p-value`, `R-squared`) %>% 
  mutate_if(is.numeric, round, 2) %>% 
  mutate(
    `Unstandardized Beta (texts)` = round(estimatefinal_in$`Unstandardized Beta (texts)`, 4),
    `Unstandardized Beta (time)`  = round(estimatefinal_in2$`Unstandardized Beta (time)`, 4),
    `Unstandardized Beta (texts*time)` = round(estimatefinal_in3$`Unstandardized Beta (texts*time)`, 4),
    `F-value`               = ifelse(`F-value`                 == 0.00, "< 0.01", `F-value`    ),
    `p-value`               = ifelse(`p-value`                 == 0.00, "< .01", `p-value`    ),
    `R-squared`             = ifelse(`R-squared`               == 0.00, "< .01", `R-squared` ),
    
    `Market Name` = ifelse(`Market Name` == "sp500", "Absolute Close Price", `Market Name`),
    `Market Name` = ifelse(`Market Name` == "sp500 difference", "Daily Difference Close Price", `Market Name`) #,
 #   `Market Name` = ifelse(`Market Name` == "Dow Jones", "Dow Jones close price (Absolute)", `Market Name`),
  #  `Market Name` = ifelse(`Market Name` == "Dow Jones difference", "Dow Jones close price (Daily Difference)", `Market Name`)
    ) %>% 
    mutate(
    `Unstandardized Beta (texts)` = ifelse(`Unstandardized Beta (texts)` > 0.00, 
                                                            paste0(as.character(`Unstandardized Beta (texts)`), "*"), 
                                                            `Unstandardized Beta (texts)`), 
         
         `Unstandardized Beta (time)` = ifelse(`Unstandardized Beta (time)` > 0.00, 
                                                           paste0(as.character(`Unstandardized Beta (time)`), "*"), 
                                                           `Unstandardized Beta (time)`),
         `Unstandardized Beta (texts*time)`= ifelse(`Unstandardized Beta (texts*time)` < 0.00, 
                                                                 paste0(as.character(`Unstandardized Beta (texts*time)`), "*"), 
                                                                 `Unstandardized Beta (texts*time)`),
     `Unstandardized Beta (texts*time)`= ifelse(`Unstandardized Beta (texts*time)` == "2e-04", 
                                                                 "0.0002", 
                                                                 `Unstandardized Beta (texts*time)`),
         ) %>% 
  
    rename(`Texts` = "Unstandardized Beta (texts)",
           `Time` = "Unstandardized Beta (time)",
           `Texts*Time` = "Unstandardized Beta (texts*time)",
           `S&P 500 Index` = "Market Name")



reg_table_in %>% 
  kbl(align = "c", escape = FALSE) %>% 
  add_header_above( c("", "Regression Coefficients" = 3, "Full Model Descriptives" = 4)) %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width = TRUE, font_size = 16) %>% 
  add_footnote(label = "\n*p<.05 for individual regression coefficient\nPredictor variable = Daily quantity of texts sent between Neil and Karina\nOutcome Variable = S&P 500 close price",notation = "none") 

```

<br> **Model Scatterplots & Interpretations**

<br>

**As can be seen in the visualized models below, in the beginning of our relationship, our texts at day 0 (The lowest, darkest line) were predictive of an increase of absolute market values (An upwards slope). However, the more time that passes, the relationship between our texting and change in market values is no longer there, and eventually turns negative!**

<br>

**We welcome all our guests to share any ideas on why that might be during our wedding. :)**

#### S&P 500 (Absolute) {.tabset .tabset-fade .tabset-pills}

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}
model <- lm( `SP500_Closing_Price` ~ Number_of_texts_sent + `Days_since_first_text` + Number_of_texts_sent*`Days_since_first_text`, data = textcount_sp500)
#summary(model)

ggPredict(model, se = TRUE,  interactive = TRUE, terms = c("n_texts", "Days_since_first_text")) 
```

***Statistical Interpretation:*** This model *is* statistically significant: F(3, 407) = 1347.84, p \<.01, R<sup>2</sup> = 0.91. Suggesting that, for every 1 text we send, the S&P 500 index price is expected to increase 1.07 points at day 0 (p \<.01) - however, for every day that passes, the regression coefficient (slope) is expected to *decrease* by 0.0028 points (p \<.01). The chart above shows the expected change in slope at 0, 200, 400, 600, & 800 days since we started texting. As can be seen from the chart above, after enough time, the relationship turns from positive to negative!

#### S&P 500 (Daily Difference) {.tabset .tabset-fade .tabset-pills}

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}
model <- lm( `diff` ~ Number_of_texts_sent + `Days_since_first_text` + Number_of_texts_sent*`Days_since_first_text`, data = textcount_sp500)
#summary(model)

ggPredict(model, se = TRUE,  interactive = TRUE, terms = c("n_texts", "Days_since_first_text")) 
```

***Statistical Interpretation:*** This model is *not* statistically significant: F(3, 407) = 0.24, p \>.05, R<sup>2</sup> \< 0.01. Our texting is *not* predictive of the S&P 500 daily difference price.

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%", eval = FALSE}
#### Dow Jones (Absolute) {.tabset .tabset-fade .tabset-pills}
#
#model <- lm( `Dow_Jones_Daily_Closing_Price` ~ Number_of_texts_sent + `Days_since_first_text` + Number_of_texts_sent*`Days_since_first_text`, data = textcount_dj)
##summary(model)
#
#ggPredict(model, se = TRUE,  interactive = TRUE, terms = c("n_texts", "Days_since_first_text")) 
#
#
##*#***Statistical Interpretation:*** This model *is* statistically significant: F(3, 407) = 519.61, p \<.01, R<sup>2</sup> = 0.79. Suggesting that, for every 1 text we send, the Dow Jones index price is 
##*#expected to increase 11.40 points at day 0 (p \<.01) - however, for every day that passes, the regression coefficient (slope) is expected to *decrease* by 0.0368 points (p \<.01). The chart above shows ##the 
#*#expected change in slope at 0, 200, 400, 600, & 800 days since we started texting. As can be seen from the chart above, after enough time, the relationship turns from positive to negative!

```

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%", eval = FALSE}
#### Dow Jones (Daily Difference) {.tabset .tabset-fade .tabset-pills}
#
#model <- lm( `diff` ~ Number_of_texts_sent + `Days_since_first_text` + Number_of_texts_sent*`Days_since_first_text`, data = textcount_dj)
##summary(model)
#
#ggPredict(model, se = TRUE,  interactive = TRUE, terms = c("n_texts", "Days_since_first_text")) 
#
#
###***Statistical Interpretation:*** This model is *not* statistically significant: F(3, 407) = 1.31, p \>.05, R<sup>2</sup> \< 0.01. Our texting is *not* predictive of the Dow Jones daily difference price.

```

### CAPM<br>Betas {.tabset .tabset-fade .tabset-pills}

One interesting factor about our spending that corresponds to the overall market performance, is that some of our favorite brands move in line with the market, or in fact are even more volatile in the direction that the market moves, i.e. when the market goes up, our brands go up even more (Betas \> 1).

#### Our<br>Brands {.tabset .tabset-fade .tabset-pills}

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}


betas <- betas %>% 
  filter(Ticker != "MTCH")

betas_out <- betas %>% 
  filter(Ticker != "SPY") %>% 
  anti_join(sp500_betas, by = "Ticker") %>% 
  select(Ticker, Beta, `Standard Error`) %>% 
  mutate(Ticker = ifelse(Ticker %in% sp500_betas$Ticker, Ticker, paste0(Ticker, "*")))


betas_table <- betas %>% 
  mutate(Ticker = ifelse(Ticker %in% sp500_betas$Ticker, Ticker, paste0(Ticker, "*")),
         Ticker = ifelse(Ticker == "SPY*", "SPY", Ticker), 
         `Asset Name` = ifelse(`Asset Name` == "S&P 500", "S&P 500 (Reference)", `Asset Name`)) %>% 
  rename(Company = "Asset Name") %>% 
  filter(Ticker != "MTCH")

#betas_table %>% 
#  kbl(align = "c", escape = TRUE) %>% 
#  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width = TRUE, font_size = 16) %>% 
#  add_footnote(label = "Date Range: 2022-10-03 - 2024-09-20") %>% 
#  add_footnote(label = "*Ticker not present in S&P 500", notation = "none")



datatable(betas_table, escape = FALSE, rownames = FALSE, options = list(pageLength = length(betas_table$Company), paging = FALSE),
            caption = htmltools::tags$caption(
    style = 'caption-side: bottom; text-align: left;',
    ' Date Range: 2022-10-03 - 2024-09-20 | *Ticker not present in S&P 500')) %>% 
  formatRound(c("Beta", "Standard Error"), digits = 2) %>% 
    formatStyle(
    c(1:4),
    target = "row",
    fontWeight = styleEqual(c(1,2), "bold")
  )

```

**In the chart below, we wanted to illustrate the overall distribution of S&P500 stocks by their Betas. Note, most of our favorite brands show a beta above 1!**

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}

betas_nosp <- betas_table %>% 
  filter(Ticker != "SPY",
         Ticker != "MTCH")


sp500_betas_plus <- sp500_betas %>% 
  mutate(Ticker = ifelse(Ticker %in% betas$Ticker, Ticker, "Other S&P 500 ticker")) %>% 
  bind_rows(betas_out) %>%  
  mutate(
         Ticker = factor(Ticker, levels = c(betas_nosp$Ticker, "Other S&P 500 ticker"), labels = c(1:length(unique(betas$Ticker)) - 1)),
         Ticker = factor(Ticker, labels = c(betas_nosp$Ticker, "Other S&P 500 ticker"), levels = c(1:length(unique(betas$Ticker)) - 1))
         )


p_sp500_betas <- ggplot(sp500_betas_plus, aes(x = Beta, fill = Ticker)) + 
  geom_histogram(bins = 40) + 
  scale_fill_manual(values = c( "#ff9900", "#FF6A60", "#1fbad6", "#451400", "#007cba", "#104c8c", "#000000", "#87CEEB", "#006241",  "grey", "blue")) +
  geom_segment(aes(x= (mean(Beta[Ticker != "Other S&P 500 ticker"])), xend=   (mean(Beta[Ticker != "Other S&P 500 ticker"])), y=43, yend= 49 ), linewidth = .009, color = "deepskyblue") +
  geom_point(aes(x = (mean(Beta[Ticker != "Other S&P 500 ticker"]))       , y = 46  ), size = 2.5, color = "deepskyblue", fill = "deepskyblue", shape = 16)  +
  labs(y = "") +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
 # geom_vline(xintercept  = mean(betas$Beta), color = "blue", show.legend = TRUE) +
  theme_classic() 

  
ticker_hist <- ggplotly(p_sp500_betas, tooltip = c("count", "Ticker")) %>% 
  style(hovertext = paste0("Company: ", betas_table$Company[2]  ,"\nTicker: ",  betas_table$Ticker[2] , "\nBeta: ", betas_table$Beta[2]  ), traces = 1  ) %>% 
  style(hovertext = paste0("Company: ", betas_table$Company[3]  ,"\nTicker: ",  betas_table$Ticker[3] , "\nBeta: ", betas_table$Beta[3]  ), traces = 2  ) %>% 
  style(hovertext = paste0("Company: ", betas_table$Company[4]  ,"\nTicker: ",  betas_table$Ticker[4] , "\nBeta: ", betas_table$Beta[4]  ), traces = 3  ) %>% 
  style(hovertext = paste0("Company: ", betas_table$Company[5]  ,"\nTicker: ",  betas_table$Ticker[5] , "\nBeta: ", betas_table$Beta[5]  ), traces = 4  ) %>% 
  style(hovertext = paste0("Company: ", betas_table$Company[6]  ,"\nTicker: ",  betas_table$Ticker[6] , "\nBeta: ", betas_table$Beta[6]  ), traces = 5  ) %>% 
  style(hovertext = paste0("Company: ", betas_table$Company[7]  ,"\nTicker: ",  betas_table$Ticker[7] , "\nBeta: ", betas_table$Beta[7]  ), traces = 6  ) %>% 
  style(hovertext = paste0("Company: ", betas_table$Company[8]  ,"\nTicker: ",  betas_table$Ticker[8] , "\nBeta: ", betas_table$Beta[8]  ), traces = 7  ) %>% 
  style(hovertext = paste0("Company: ", betas_table$Company[9]  ,"\nTicker: ",  betas_table$Ticker[9] , "\nBeta: ", betas_table$Beta[9]  ), traces = 8  ) %>% 
  style(hovertext = paste0("Company: ", betas_table$Company[10] ,"\nTicker: ",  betas_table$Ticker[10], "\nBeta: ", betas_table$Beta[10] ), traces = 9  ) %>% 
#  style(hovertext = paste0("Company: ", betas_table$Company[11] ,"\nTicker: ",  betas_table$Ticker[11], "\nBeta: ", betas_table$Beta[11] ), traces = 10 )  %>% 
  style(hovertext = paste("Average Beta of our companies:", (round(mean(sp500_betas_plus$Beta[sp500_betas_plus$Ticker != "Other S&P 500 ticker"]), 2))), traces = 21) %>% 
    style(hoverinfo = "none", traces = 20)


ticker_hist

```

<sup>\*Ticker not present in S&P 500</sup>


**However, our special mention goes to Match Group Inc. with a whooping beta of 2.29! After all, if not for its Tinder brand we would not be here today. The graph below illustrates how small changes in the market coincide in outsized movements in Tinder's share price.** 

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}
p_tindersp500 <- ggplot(tindersp500_long, aes(x = Date, y = `Month Over Month %Change`, color = Company)) + 
  geom_hline(yintercept = 0, color = "black", alpha = .5, linetype='dotted') +
  geom_line() +
  scale_color_manual(values = c( "#000000", "#FD2B7B")) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") +
  scale_y_continuous(labels = scales::percent_format()) + # , n.breaks = 20, limits = c(0, 14000)) +
  labs(x = "", color = "") #+
#  theme(legend.position="none") 

plotly_tindersp500 <- ggplotly(p_tindersp500) %>% 
  style(hoverinfo = "none", traces = 1)

plotly_tindersp500 

```




#### The S&P 500 Index Betas {.tabset .tabset-fade .tabset-pills}

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}
datatable(sp500_betas, escape = FALSE, rownames = FALSE, options = list(pageLength = length(betas_table$Company)),
            caption = htmltools::tags$caption(
    style = 'caption-side: bottom; text-align: left;',
    'Date Range: 2022-10-03 - 2024-09-20 | Note: GEV, KVUE, GEHC, VLTO, SW, & SOLV removed due to missing data in date range')  ) %>% 
  formatRound(c("Beta", "Standard Error"), digits = 2) 
```

**In the chart below, we wanted to illustrate the overall distribution of S&P500 stocks by their Betas. Note, most of our favorite brands show a beta above 1!**

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}

ticker_hist

```

<sup>\*Ticker not present in S&P 500</sup>



**However, our special mention goes to Match Group Inc. with a whooping beta of 2.29! After all, if not for its Tinder brand we would not be here today. The graph below illustrates how small changes in the market coincide in outsized movements in Tinder's share price.** 

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}
plotly_tindersp500 
```

### Macro Spending Trends {.tabset .tabset-fade .tabset-pills}

**Another explanation to the correlation between our relationship and the overall market could be that the early days of our relationship coincided with a broader increase in discretionary spending in the US. As seen in the charts below, everyone in the US has increased spending on nondurable goods and on services since we first met.**

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}

ndgoods_service <- ggplot(cus_spend_ndgoods_service, aes(x = `Month-Year`, y = `Total Customer Spending (Billions)`, color = `Spending Type` )) +
  geom_line() +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") +
  scale_y_continuous(labels = scales::dollar_format(prefix="$")) + # , n.breaks = 20, limits = c(0, 14000)) +
  labs(x = "", y = "Total Customer Spending (Billions)") +
  theme(legend.position="none") +
  facet_wrap(~`Spending Type`, scales = "free_y") 

ndgoods_service_plotly <- ggplotly(ndgoods_service) %>% 
   layout(hovermode = 'x') %>%
    style(hovertext = paste0('Total Customer Spending (Billions): $', cus_spend_long$`Total Customer Spending (Billions)`[cus_spend_long$`Spending Type` == "Nondurable oods"], 
                 '<br>Month-Year: ', format(as.Date(cus_spend_long$`Month-Year`[cus_spend_long$`Spending Type` == "Nondurable goods"]), "%B-%Y"),
                 '<br>Spending Type: ', cus_spend_long$`Spending Type`[cus_spend_long$`Spending Type` == "Nondurable goods"]), traces = 1) %>% 
    style(hovertext = paste0('Total Customer Spending (Billions): $', cus_spend_long$`Total Customer Spending (Billions)`[cus_spend_long$`Spending Type` == "Services"],
                 '<br>Month-Year: ', format(as.Date(cus_spend_long$`Month-Year`[cus_spend_long$`Spending Type` == "Services"]), "%B-%Y"),
                 '<br>Spending Type: ', cus_spend_long$`Spending Type`[cus_spend_long$`Spending Type` == "Services"]), traces = 2) 


ndgoods_service_plotly
```
<sup>Source: U.S. Bureau of Economic Analysis</sup>

#  

<center><img src="KN.png" width="20%"/></center>

<center><img src="final_image.png" width="20%"/></center>

[**Click here to go back to our wedding website**](https://www.theknot.com/us/karina-convers-and-neil-yetz-aug-2025)

~Interested in how these charts were made?: [Click here to see our Github repository!](https://github.com/ndyetz/ourloveinnumbers.github.io)~
