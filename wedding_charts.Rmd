---
title: "&nbsp;"
output:
  html_document:
    author: "Karina and Neil"
    df_print: paged
  html_notebook:
    toc: true
    toc_float: true
---

```{r, echo = FALSE}
# Change to html if necessary
#
#<!-- html code to remove Rmarkdown size containment -->
#
#<style type="text/css">
#.main-container {
#  max-width: 100% !important;
#  margin: auto;
#}
#</style>
```

```{=html}

<style>
    body { background-color: #FFFFFF; }
    pre, pre:not([class]) { background-color: #FFFFFF; }
</style>
```
```{=html}

<style type="text/css">
.hovertext text {
    font-size: 18px !important;
    font-family: Georgia, serif;
}
</style>
```
```{css, echo=FALSE}
p {
  font-size: 18px;
  font-family: Georgia, serif;
}
```

```{css, echo=FALSE}
h1, h2, h3 {
  font-family: Georgia, serif;
  font-weight: bold;
  color: #64798B;
}
```

```{css, echo = FALSE}
  .nav-pills>li>a:hover, .nav-pills>li>a:focus, .nav-pills>li.active>a,   .nav-pills>li.active>a:hover, .nav-pills>li.active>a:focus{
  background-color: #64798B;
  font-weight: bold;
  text-align: center;
  font-color: "white";
}


.nav-pills {
  text-align: center;
}
```

```{css, echo=FALSE}

.break .nav-pills {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  text-align: center;
}

.break .nav-pills:before,
.break .nav-pills:after {
  content: unset;
}
```

```{r, message = FALSE, echo = FALSE, warning = FALSE}
#Clear Environment
#rm(list = ls())
```

```{r, message = FALSE, echo = FALSE, warning = FALSE}

#Currently being run in "run.R"

#Libraries and functions (Includes Dates)
#source("source_functions.R")

# Load data and formatting
#source("source_file.R")

# Google API. for google_maps(). Function will not work without API key.
#source("private_key.R")
```

# Â  {.tabset .tabset-fade .tabset-pills .break}

## Home<br>Page {.tabset .tabset-fade .tabset-pills}

<center>![](mountain_website.png){width="20%"}</center>

<center>![](love_in_charts.png){width="80%"}</center>

<center>![](names.png){width="50%"}</center>

<center>![](together.png){width="70%"}</center>

## Texting<br>Data {.tabset .tabset-fade .tabset-pills}

### Word Cloud {.tabset .tabset-fade .tabset-pills}

We created a word cloud of the words we text to eachother most often below:

**"*Baby*", "*Babe*", "*Love*", and "*Lol*" are a few of our most frequently used words!**

```{r, echo = FALSE}
#Word cloud image in markdown below. 
```

<center><img src="word_cloud.png" width="80%"/></center>

### Our texts over time {.tabset .tabset-fade .tabset-pills}

**Sent Texts Quantity**

Our first winter together, texting \~600 times a week was the norm. Since Neil moved in, our texting slowed down quite a bit.

```{r, echo = FALSE, out.height= "100%", out.width = "100%", warning = FALSE}
#Custom Functions
p_texts_quant_time <- line_plots_quant(data = texts_quant_graph, x = week_of, y = `# of texts sent`)
hover_range_quant(p_texts_quant_time)
```

<sup>*Hover over the chart and milestones for more information about our milestones and texting. Or click on the chart legend to show/hide any milestones or trends.*</sup>

**Average Character Count Per Text**

There seems to be a *slight* downward trend in the length of the texts that we send each other - however, certain events seem to spike longer texts towards one another. The week after we got engaged, Neil's character count increased dramatically! 

```{r, echo = FALSE, out.height= "100%", out.width = "100%", warning = FALSE}

texts_char_time_graph <- line_plots_quant(data = texts_char_time, x = week_of, y = `Average character count`)
hover_range_quant(texts_char_time_graph)
```

<sup>*Hover over the chart and milestones for more information about our milestones and texting. Or click on the chart legend to show/hide any milestones or trends.*</sup>

### Total Texts {.tabset .tabset-fade .tabset-pills}

*Below are two bar charts showing the total number of texts we have sent to eachother and the average number of text characters in each of our text messages to eachother.*

**Neil doesn't always respond! Karina has sent over 1,000 more texts to Neil since they have known each other.**

```{r, echo = FALSE, out.height= "100%", out.width = "100%"}
#Overall texts

p_sent <- ggplot(text_quant_graph, aes(x = `Sent by`, y = `# of texts sent` , fill = `Sent by`)) +
  geom_col(position = "dodge") +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  geom_text(
    aes(label = paste0(`# of texts sent`, " Texts\n "), lineheight = .83),
    position = position_dodge(.8),
    vjust = 30,
    size = 5) +
  labs(title = "",
       x = "") +
  theme_minimal() +
  #  theme(axis.text.x = element_text(angle = 45,  hjust=1))  +
  theme(axis.text.x = element_text(size=11, face="bold", color = "black"), legend.title=element_blank()) 


ggplotly(p_sent) #%>% 
 # layout(hovermode = 'x')
```
 <sup>*Click on the chart legend to show/hide any bars.*</sup>

**But when Neil responds, he has more to say! Neil's sent texts are 5 characters longer, on average.**

```{r, echo = FALSE, out.height= "100%", out.width = "100%"}

p_character_sent <- ggplot(text_character_graph, aes(x = `Sent by`, y = `Average number of characters in text` , fill = `Sent by`)) +
  geom_col(position = "dodge") +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  geom_text(
    aes(label = paste0(round(`Average number of characters in text`, 2) , "\n "), lineheight = .83),
    position = position_dodge(.8),
    vjust = 30,
    size = 5) +
  labs(title = "",
       x = "") +
  theme_classic() +
  #  theme(axis.text.x = element_text(angle = 45,  hjust=1))  +
  theme(axis.text.x = element_text(size=11, face="bold", color = "black"), legend.title=element_blank()) 


ggplotly(p_character_sent) %>% 
#  layout(hovermode = 'x')
  style(hoverinfo = "none", traces = 3:4) 
```
 <sup>*Click on the chart legend to show/hide any bars.*</sup>
 
### Our Favorite Words to Text {.tabset .tabset-fade .tabset-pills}

#### Overall {.tabset .tabset-fade .tabset-pills}

*In the chart below, we selected words that we use frequently, or we feel are special to us* (Note: *Ben* is the name of Karina's son and *Laika* is the name of Neil's dog!).

**Look below to see that Karina says "*Baby*" a lot, and Neil "*Laughs Out Loud*" a lot.**

```{r, echo = FALSE, out.height= "100%", out.width = "100%"}
# Count of chosen words.
final_text_search_graph <- final_text_search %>% 
  pivot_longer(-`Sent by`, values_to = "# of times word(s) was used") %>% 
  filter(`Sent by` != "Total") %>% 
    mutate(name = factor(name, levels = c("Baby", "Babe", "Love you", "Ben", "Laika", "Good morning","Good night", "Lol"),    labels = c(1,2,3,4,5,6,7,8)),
         name = factor(name,   labels = c("Baby", "Babe", "Love you", "Ben", "Laika", "Good morning", "Good night", "Lol" ),  levels = c(1,2,3,4,5,6,7,8)),
         ) %>% 
  rename(`Word(s)` = "name")

ptotal <- ggplot(final_text_search_graph, aes(x = `Word(s)`, y = `# of times word(s) was used`, fill = `Sent by`)) +
  geom_col(position = "dodge") +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  geom_text(
    aes(label = paste0(`# of times word(s) was used`, "\n "), lineheight = .83),
    position = position_dodge(.8),
    vjust = 30,
    size = 4.5) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45,  hjust=1))  +
  theme(axis.text.x = element_text(size=11, face="bold", color = "black"), legend.title=element_blank()) +
  labs(title = "",
       x = "") 
  
ggplotly(ptotal)  %>% 
 # layout(hovermode = 'x')
    style(hoverinfo = "none", traces = 3:4) 


```
 <sup>*Click on the chart legend to show/hide any bars.*</sup>

#### Over Time {.tabset .tabset-fade .tabset-pills}

*Take a look at our trends in the selected words we text each other below!*

**For better interpretability,** we highlighted certain sections of this graph to tell a few stories. Check out the tabs below to see some interesting trends we found!

##### "Love you"

Right after we decided to make it an official relationship, "Love you" made its way into our regular texting. We were quick to say we love eachother... And we *love* that!

```{r, echo = FALSE, fig.height= 10, out.height= "100%", out.width = "100%", warning = FALSE}

love <- texts_combine_filter_graph_groups %>% 
  filter(`Word(s)` == "Love you")

plove <- ggplot(love, aes(x = week_of, y = `Count of particular word(s) used in our texts`, color = `Word(s)`)) +
  geom_line(linewidth = .6) + 
  scale_color_manual(values = c( "#E8AE4C", "#4CD2D6")) +
  facet_wrap(~title) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") + 
  labs(title = "",
       x = "") +
  theme(
#   strip.background = element_rect(
#     color="#64798B",  linewidth =1, linetype="solid"
#     ),
   strip.text.x = element_text(
        size = 12, color = "black", face = "bold.italic"
        )
   ) +
  geom_point(aes(x = (Relationship)     , y = 25 , color = "Relationship"    ), shape=18, size = 2.5) +
  geom_segment(aes(x=       (Relationship)            ,         xend=   (Relationship)         , y=0, yend= 25, color =            "Relationship"          ), linewidth = .05)


ggplotly(plove) %>% 
  layout(hovermode = 'x') %>% 
   style(hovertext = paste0("We make it official, we decide we want to be in a relationship on " , format(as_date(Relationship), "%b %d, %Y"), '. \nWe also said "I love you" in person for the first time on this day.')                , traces = 3:4  ) %>% 
style(hoverinfo = "none", traces = 5:6) 
```
<sup>*Click on the chart legend to show/hide any milestones or trends.*</sup>

##### "Baby" vs "Babe"

At the beginning of their relationship, Neil rarely used the word "Baby" but overtime he seems to mimic the way Karina used the word. An increase in Neil texting the word "Baby" can be seen after we move in together.

```{r, echo = FALSE, fig.height= 10, out.height= "100%", out.width = "100%", warning = FALSE}



baby <- texts_combine_filter_graph_groups %>% 
  filter(`Word(s)` == "Baby")

pbaby <- ggplot(baby, aes(x = week_of, y = `Count of particular word(s) used in our texts`, color = `Word(s)`)) +
  geom_line(linewidth = .6) + 
    scale_color_manual(values = c( "#FA9F99", "#EB99F8")) +
  facet_wrap(~title) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") + 
  labs(title = "",
       x = "") +
  theme(
#   strip.background = element_rect(
#     color="#64798B",  linewidth =1, linetype="solid"
#     ),
   strip.text.x = element_text(
        size = 12, color = "black", face = "bold.italic"
        )
   ) +
  geom_point(aes(x = (`Neil moves in`)     , y = 130 , color = "Neil moves in"    ), shape=18, size = 2.5) +
  geom_segment(aes(x=       (`Neil moves in`)            ,         xend=   (`Neil moves in`)         , y=0, yend= 130, color =            "Neil moves in"          ), linewidth = .05) 


ggplotly(pbaby) %>% 
  layout(hovermode = 'x') %>% 
  style(hovertext = paste0("Neil moved in with Karina on "                                     , format(as_date(`Neil moves in`), "%b %d, %Y"), ".")                                                                                   , traces = 3:4 ) %>% 
style(hoverinfo = "none", traces = 5:6)

```
<sup>*Click on the chart legend to show/hide any milestones or trends.*</sup>

Furthermore, if you look at the trend of the word "Babe" among each of us, Neil has used "Babe" much less in his current texts than with Karina, but Karina rarely used that word to start with!

```{r, echo = FALSE, fig.height= 10, out.height= "100%", out.width = "100%", warning = FALSE}

  
babe <- texts_combine_filter_graph_groups %>% 
  filter(`Word(s)` == "Babe")

pbabe <- ggplot(babe, aes(x = week_of, y = `Count of particular word(s) used in our texts`, color = `Word(s)`)) +
  geom_line(linewidth = .6) + 
  scale_color_manual(values = c( "#ED813E", "#EB99F8")) +
  facet_wrap(~title) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") + 
  labs(title = "",
       x = "") +
  theme(
#   strip.background = element_rect(
#     color="#64798B",  linewidth =1, linetype="solid"
#     ),
   strip.text.x = element_text(
        size = 12, color = "black", face = "bold.italic"
        )
   ) +
  geom_point(aes(x = (`Neil moves in`)     , y = 120 , color = "Neil moves in"    ), shape=18, size = 2.5) +
  geom_segment(aes(x=       (`Neil moves in`)            ,         xend=   (`Neil moves in`)         , y=0, yend= 120, color =            "Neil moves in"          ), linewidth = .05)


ggplotly(pbabe) %>% 
  layout(hovermode = 'x') %>% 
  style(hovertext = paste0("Neil moved in with Karina on "                                     , format(as_date(`Neil moves in`), "%b %d, %Y"), ".")                                                                                   , traces = 3:4 ) %>% 
style(hoverinfo = "none", traces = 5:6)

```
<sup>*Click on the chart legend to show/hide any milestones or trends.*</sup>

##### An increase in "Ben" {.tabset .tabset-fade .tabset-pills}

Notice how Ben (Karina's son) becomes a topic of conversation much more frequently after he was introduced to Neil.

```{r, echo = FALSE, fig.height= 10, out.height= "100%", out.width = "100%", warning = FALSE}


  
ben <- texts_combine_filter_graph_groups %>% 
  filter(`Word(s)` == "Ben")

pben <- ggplot(ben, aes(x = week_of, y = `Count of particular word(s) used in our texts`, color = `Word(s)`)) +
  geom_line(linewidth = .6) + 
  scale_color_manual(values = c( "#DCB54C", "#4CCFE6")) +
  facet_wrap(~title) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") + 
  labs(title = "",
       x = "") +
  theme(
#   strip.background = element_rect(
#     color="#64798B",  linewidth =1, linetype="solid"
#     ),
   strip.text.x = element_text(
        size = 12, color = "black", face = "bold.italic"
        )
   ) +
  geom_point(aes(x = (`Neil Meets Ben`)     , y = 40 , color = "Neil Meets Ben"    ), shape=18, size = 2.5) +
  geom_segment(aes(x=       (`Neil Meets Ben`)            ,         xend=   (`Neil Meets Ben`)         , y=0, yend= 40, color =            "Neil Meets Ben"          ), linewidth = .05)


ggplotly(pben) %>% 
  layout(hovermode = 'x') %>% 
  style(hovertext = paste0("We go snowboarding with Karina's son, Ben, on "                   , format(as_date(`Neil Meets Ben`), "%b %d, %Y"), ". It's the first time Neil met Ben.")                                                , traces = 3:4  ) %>% 
style(hoverinfo = "none", traces = 5:6)

```
<sup>*Click on the chart legend to show/hide any milestones or trends.*</sup>

<sup>*Note: One of Neil's best friends is also named Ben, so some of this data may be inflated.*</sup>

##### Neil Likes to "Lol" {.tabset .tabset-fade .tabset-pills}

**After we made our relationship official,** Neil started to "Laugh Out Loud" much more frequently. Karina "Laughed Out Loud" at a pretty low frequency throughout their relationship.

```{r, echo = FALSE, fig.height= 10, out.height= "100%", out.width = "100%", warning = FALSE}

lol <- texts_combine_filter_graph_groups %>% 
  filter(`Word(s)` == "Lol")



plol <- ggplot(lol, aes(x = week_of, y = `Count of particular word(s) used in our texts`, color = `Word(s)`)) +
  geom_line(linewidth = .6) + 
    scale_color_manual(values = c( "#49B500", "#4CD2D6")) +
  facet_wrap(~title) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") + 
  labs(title = "",
       x = "") +
  theme(
#   strip.background = element_rect(
#     color="#64798B",  linewidth =1, linetype="solid"
#     ),
   strip.text.x = element_text(
        size = 12, color = "black", face = "bold.italic"
        )
   ) +
  geom_point(aes(x = (Relationship)     , y = 120 , color = "Relationship"    ), shape=18, size = 2.5) +
  geom_segment(aes(x=       (Relationship)            ,         xend=   (Relationship)         , y=0, yend= 120, color =            "Relationship"          ), linewidth = .05)


ggplotly(plol) %>% 
  layout(hovermode = 'x') %>% 
   style(hovertext = paste0("We make it official, we decide we want to be in a relationship on " , format(as_date(Relationship), "%b %d, %Y"), '. \nWe also said "I love you" in person for the first time on this day.')                , traces = 3:4  ) %>% 
style(hoverinfo = "none", traces = 5:6) 
```
<sup>*Click on the chart legend to show/hide any milestones or trends.*</sup>


##### The Fall of "Good Morning" {.tabset .tabset-fade .tabset-pills}

**From December through February**, we were saying "Good morning" to eachother nearly everyday. Since the end of February, the number of times we say "Good morning" to eachother via text is nearly zero. Although we started "officially" living with eachother in August, we have been seeing eachother every morning for quite a while. We get to wish eachother a good morning in person everyday, now! The only time we text each other "Good morning" or "Good night" now is when one of us are away.

```{r, echo = FALSE, fig.height= 10, out.height= "100%", out.width = "100%", warning = FALSE}


 
morn <- texts_combine_filter_graph_groups %>% 
  filter(`Word(s)` == "Good morning")

pmorn <- ggplot(morn, aes(x = week_of, y = `Count of particular word(s) used in our texts`, color = `Word(s)`)) +
  geom_line(linewidth = .6) + 
      scale_color_manual(values = c("#BAC14C", "#EB99F8")) +
  facet_wrap(~title) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") + 
  labs(title = "",
       x = "") +
  theme(
#   strip.background = element_rect(
#     color="#64798B",  linewidth =1, linetype="solid"
#     ),
   strip.text.x = element_text(
        size = 12, color = "black", face = "bold.italic"
        )
   ) +
  geom_point(aes(x = (`Neil moves in`)     , y = 10 , color = "Neil moves in"    ), shape=18, size = 2.5) +
  geom_segment(aes(x=       (`Neil moves in`)            ,         xend=   (`Neil moves in`)         , y=0, yend= 10, color =            "Neil moves in"          ), linewidth = .05)


ggplotly(pmorn) %>% 
  layout(hovermode = 'x') %>% 
  style(hovertext = paste0("Neil moved in with Karina on "                                     , format(as_date(`Neil moves in`), "%b %d, %Y"), ".")                                                                                   , traces = 3:4 ) %>% 
style(hoverinfo = "none", traces = 5:6)

```
<sup>*Click on the chart legend to show/hide any milestones or trends.*</sup>


##### All<br>Words {.tabset .tabset-fade .tabset-pills}

```{r, echo = FALSE, fig.height= 10, out.height= "100%", out.width = "100%", warning = FALSE}

  

pbabe <- ggplot(texts_combine_filter_graph_groups, aes(x = week_of, y = `Count of particular word(s) used in our texts`, color = `Word(s)`)) +
  geom_line(linewidth = .6) + 
  facet_wrap(~title) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") + 
  labs(title = "",
       x = "") +
  theme(
#   strip.background = element_rect(
#     color="#64798B",  linewidth =1, linetype="solid"
#     ),
   strip.text.x = element_text(
        size = 12, color = "black", face = "bold.italic"
        )
   ) +
  geom_point(aes(x = (`First Kiss`)     , y = 140 , color = "First Kiss"      ), shape=18, size = 2.5) +
  geom_point(aes(x = (`New York`)       , y = 140 , color = "New York"        ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Snowboarding`)   , y = 140 , color = "Snowboarding"    ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Meet Parents`)   , y = 140 , color = "Meet Parents"    ), shape=18, size = 2.5) +
  geom_point(aes(x = (Relationship)     , y = 140 , color = "Relationship"    ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Neil Meets Ben`) , y = 140 , color = "Neil Meets Ben"  ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Build Furniture`), y = 140 , color = "Build Furniture" ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Duck Fence`)     , y = 140 , color = "Duck Fence"      ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Chicago`)        , y = 140 , color = "Chicago"         ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Duck Pond`)      , y = 140 , color = "Duck Pond"       ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Dirt Bikes`)     , y = 140 , color = "Dirt Bikes"      ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Neil moves in` ) , y = 140 , color = "Neil moves in"   ), shape=18, size = 2.5) +
  geom_point(aes(x = (`Scuba Diving` )  , y = 140 , color = "Scuba Diving"    ), shape=18, size = 2.5) +
  geom_point(aes(x = (`We Get Engaged!`), y = 140 , color = "We Get Engaged!" ), shape=18, size = 2.5) +   
  geom_point(aes(x = (`Tahiti Trip`)    , y = 140 , color = "Tahiti Trip"     ), shape=18, size = 2.5) +
  geom_point(aes(x = (`We Buy Property`), y = 140 , color = "We Buy Property" ), shape=18, size = 2.5) +
  
  
  geom_segment(aes(x=       (`First Kiss`)            ,         xend=   (`First Kiss`)         , y=0, yend= 140 , color =            "First Kiss"            ), linewidth = .05) +
  geom_segment(aes(x=       (`New York`)              ,         xend=   (`New York`)           , y=0, yend= 140 , color =            "New York"              ), linewidth = .05) +
  geom_segment(aes(x=       (`Snowboarding`)          ,         xend=   (`Snowboarding`)       , y=0, yend= 140 , color =            "Snowboarding"          ), linewidth = .05) +
  geom_segment(aes(x=       (`Meet Parents`)          ,         xend=   (`Meet Parents`)       , y=0, yend= 140 , color =            "Meet Parents"          ), linewidth = .05) +
  geom_segment(aes(x=       (Relationship)            ,         xend=   (Relationship)         , y=0, yend= 140 , color =            "Relationship"          ), linewidth = .05) +
  geom_segment(aes(x=       (`Neil Meets Ben`)        ,         xend=   (`Neil Meets Ben`)     , y=0, yend= 140 , color =            "Neil Meets Ben"        ), linewidth = .05) +
  geom_segment(aes(x=       (`Build Furniture`)       ,         xend=   (`Build Furniture`)    , y=0, yend= 140 , color =            "Build Furniture"       ), linewidth = .05) +
  geom_segment(aes(x=       (`Duck Fence`)            ,         xend=   (`Duck Fence`)         , y=0, yend= 140 , color =            "Duck Fence"            ), linewidth = .05) +
  geom_segment(aes(x=       (`Chicago`)               ,         xend=   (`Chicago`)            , y=0, yend= 140 , color =            "Chicago"               ), linewidth = .05) +
  geom_segment(aes(x=       (`Duck Pond`)             ,         xend=   (`Duck Pond`)          , y=0, yend= 140 , color =            "Duck Pond"             ), linewidth = .05) +
  geom_segment(aes(x=       (`Dirt Bikes`)            ,         xend=   (`Dirt Bikes`)         , y=0, yend= 140 , color =            "Dirt Bikes"            ), linewidth = .05) +
  geom_segment(aes(x=       (`Neil moves in` )        ,         xend=   (`Neil moves in` )     , y=0, yend= 140 , color =            "Neil moves in"         ), linewidth = .05) +
  geom_segment(aes(x=       (`Scuba Diving` )         ,         xend=   (`Scuba Diving` )      , y=0, yend= 140 , color =            "Scuba Diving"          ), linewidth = .05) +
  geom_segment(aes(x=       (`We Get Engaged!`)       ,         xend=   (`We Get Engaged!`)    , y=0, yend= 140 , color =            "We Get Engaged!"       ), linewidth = .05) +
  geom_segment(aes(x=       (`Tahiti Trip`)           ,         xend=   (`Tahiti Trip`)        , y=0, yend= 140 , color =            "Tahiti Trip"           ), linewidth = .05) +
  geom_segment(aes(x=       (`We Buy Property`)       ,         xend=   (`We Buy Property`)    , y=0, yend= 140 , color =            "We Buy Property"       ), linewidth = .05) 

ggplotly(pbabe) %>% 
#  layout(hovermode = 'x') %>%
 # style(visible='legendonly', traces = 1:2 )   %>% 
 #style(visible='legendonly',  traces = 2:3)   %>% 
  
  
  style(hovertext = paste0("Our first kiss was on "                                            , format(as_date(`First Kiss`), "%b %d, %Y"), "!")                                                                                      , traces = 17:18  ) %>% 
  style(hovertext = paste0("We take our first trip to New York together on "                   , format(as_date(`New York`), "%b %d, %Y"), ".\nThis is also the first time Neil Met Karina's parents.")                               , traces = 19:20  ) %>% 
  style(hovertext = paste0("Our first time ever snowboarding together was on "                 , format(as_date(`Snowboarding`), "%b %d, %Y"), ".\nNeil proved he can shred to Karina!")                                              , traces = 21:22  ) %>% 
  style(hovertext = paste0("Karina flies to Alpine, CA to meet Neil's parents on "             , format(as_date(`Meet Parents`), "%b %d, %Y"), ".\nWe played card games all New Years Eve and kissed at midnight!")                   , traces = 23:24  ) %>% 
  style(hovertext = paste0("We make it official, we decide we want to be in a relationship on" , format(as_date(Relationship), "%b %d, %Y"), '.\nWe also said "I love you" in person for the first time on this day.')                , traces = 25:26  ) %>% 
  style(hovertext = paste0("We go snowboarding with Karina's son, Ben, on "                   , format(as_date(`Neil Meets Ben`), "%b %d, %Y"), ".\nIt's the first time Neil met Ben.")                                                , traces = 27:28  ) %>% 
  style(hovertext = paste0("We build our first piece of IKEA furniture together on "           , format(as_date(`Build Furniture`), "%b %d, %Y"), ".\nSafe to say we didn't fight while building it.")                                         , traces = 29:30  ) %>% 
  style(hovertext = paste0("We built a duck fence on "                                         , format(as_date(`Duck Fence`), "%b %d, %Y"), ".\nOur first outside project!")                                                           , traces = 31:32 ) %>% 
  style(hovertext = paste0("We take a trip to Chicago on "                                     , format(as_date(`Chicago`), "%b %d, %Y"), ".\nNeil got to meet some of Karina's grad school peers.")                                    , traces = 33:34 ) %>% 
  style(hovertext = paste0("We built a duck pond on "                                          , format(as_date(`Duck Pond`), "%b %d, %Y"), ".\nA continuation of the duck fence project.")                                             , traces = 35:36 ) %>% 
  style(hovertext = paste0("We bought our dirt bikes on "                                      , format(as_date(`Dirt Bikes`), "%b %d, %Y"), ".\nWe each have a Yamaha TTR230 and we love them!")                                       , traces = 37:38 ) %>% 
  style(hovertext = paste0("Neil moved in with Karina on "                                     , format(as_date(`Neil moves in`), "%b %d, %Y"), ".")                                                                                   , traces = 39:40 ) %>% 
  style(hovertext = paste0("We go scuba diving for the first time in Key Largo, FL on "        , format(as_date(`Scuba Diving`), "%b %d, %Y"), "!")                                                                                    , traces = 41:42 ) %>%
  style(hovertext = paste0("We got engaged on "                                                , format(as_date(`We Get Engaged!`), "%b %d, %Y"), "!\nNeil hired a photographer to capture the moment at Mt. Hood Meadows ski resort.") , traces = 43:44 ) %>%
  style(hovertext = paste0("We take our first trip as an engaged coupel to Tahiti on"          , format(as_date(`Tahiti Trip`), "%b %d, %Y"), ".\nWe sailed on a Yach to different islabds for 10 days!")                               , traces = 45:46 ) %>% 
  style(hovertext = paste0("We bought a 1 acre piece of land in La Pine, OR on "               , format(as_date(`We Buy Property`), "%b %d, %Y"), ".\nOur plan is to build a getaway cabin on the land!")                               , traces = 47:48 ) %>% 
  style(hoverinfo = "none", traces = 49:80) 
```
<sup>*Click on the chart legend to show/hide any milestones or trends.*</sup>

##### Combined<br>Data {.tabset .tabset-fade .tabset-pills}

```{r, out.height= "100%", out.width = "100%", echo = FALSE, warning = FALSE}
pall <- line_plots_words(texts_combine_filter_graph_total, x = week_of, y = `Count of particular word(s) used in our texts`); 
hover_range_words(pall)
```
<sup>*Click on the chart legend to show/hide any milestones or trends.*</sup>

## Travel<br>Data {.tabset .tabset-fade .tabset-pills}

**A collage of us together in some of our favorite trips!**

<center><img src="collage.png" width="65%"/></center>

**A Map of the places we have traveled together!**

```{r, out.height= "75%", out.width = "75%", echo = FALSE, eval=TRUE}


travel <- suppress(read_csv("travel_neil.csv"))

travel <- travel %>% 
  mutate(info = paste0(place, "<br>", country, ifelse(country == "USA", ", ", ""), ifelse(!is.na(state), state, ""), "<br>", "We last visited ", place, " on ", date))
  
register_google(key = private_key, account_type = "standard")


map <- google_map(
  key = private_key,
  data = travel, 
  search_box = FALSE,
  width = 1000,
  height = 600
)

map %>%
  googleway::add_markers(lat = "lat", lon = "lon",  mouse_over = "info")
```

<sup>*Hover over the markers to get information and see when we last visited each place!*</sup>

## Snowboarding<br>Data {.tabset .tabset-fade .tabset-pills}

<center><img src="nkmeadows.png" width="200%"/></center>

Snowboarding is one of our favorite hobbies and we get data from our Mt. Hood Meadows annual ski passes. Take a look at the charts of our snowboarding data in the tabs below!

### Mt. Hood Meadows Ski Resort {.tabset .tabset-fade .tabset-pills}

**Mt. Hood Meadows Ski Resort Runs on Google Maps.**

```{r,  out.height= "75%", out.width = "75%", echo = FALSE, eval=TRUE}

mt_hood <- google_map(
  key = private_key,
  data = travel, 
  search_box = FALSE,
  width = 1000,
  height = 600, 
  location = c(45.3390, -121.6652), 
  zoom = 14#,
#  map_type = "hybrid"
) 

mt_hood %>% 
  googleway::add_markers(lat = 45.34802365909766, lon = -121.65863752775641, mouse_over = "This is where we got engaged! <br>Right in front of a waterfall in Heather Canyon!", update_map_view = FALSE)
```

<sup>*Hover over the marker to see where we got engaged!*</sup>

**Mt. Hood Trail Map**

Take a look at how awesome our local ski resort is. We love Mt. Hood Meadows!

<center><img src="meadow_map.jpg" width="75%"/></center>

### Chairlift data {.tabset .tabset-fade .tabset-pills}

#### Over Time {.tabset .tabset-fade .tabset-pills}

Each bar below represents the amount we used each ski lift at Mt. Hood Meadows ski resort on each date we snowboarded.

**By Vertical Feet Gained**

```{r, echo = FALSE,  out.height= "100%", out.width = "100%"}

vertical_feet <- ggplot(hood_vert_graph, aes(x = Date, y =  `Vertical Ft. Gained`, color = Season)) +
  geom_point(size = 3) +
  geom_segment(aes(x=Date, xend=Date, y=0, yend= `Vertical Ft. Gained`)) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
    scale_x_date(date_labels="%b %Y",date_breaks  ="1 month", expand = c(.4,0,.1,0)) +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  labs(title = "",
       x = "") +
  facet_wrap(~Season, scales = "free_x") +
  theme(legend.position="none")


ggplotly(vertical_feet) %>% 
  layout(hovermode = 'x') %>% 
  style(hoverinfo = "none", traces = 3:4)

```
<sup>*Hover over each dot to see how much vertical feet we gained on each date we snowboarded at Mt. Hood Meadows ski resort.*</sup>

**By number of Runs Completed**

Hover over each dot to see how many runs we took on each date.

```{r, echo = FALSE,  out.height= "100%", out.width = "100%"}

total_runs <- ggplot(hood_runs_graph, aes(x = Date, y =  `Total Runs`, color = Season)) +
  geom_point(size = 3) +
  geom_segment(aes(x=Date, xend=Date, y=0, yend= `Total Runs`)) +
  theme_classic() +
  scale_y_continuous(expand = c(0, 0, .14, 0)) +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  labs(title = "",
       x = "") +
  facet_wrap(~Season, scales = "free_x") +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month", expand = c(.4,0,.1,0)) +
  theme(legend.position="none")

  
ggplotly(total_runs) %>% 
  layout(hovermode = 'x')  %>% 
  style(hoverinfo = "none", traces = 3:4)

```
<sup>*Hover over each dot to see how many times we took the ski lift on each date we snowboarded at Mt. Hood Meadows ski resort.*</sup>

#### Overall {.tabset .tabset-fade .tabset-pills}

Each box below represents the amount we used the ski lifts at Mt. Hood Meadows ski resort.

**In vertical feet gained**

```{r, echo = FALSE,  out.height= "100%", out.width = "100%"}
hood_runs_tree <- hood_runs_tree %>% 
  arrange(Runs)

plot_ly(
  hood_runs_tree,
  labels = ~ Runs,
  parents = NA,
  values = ~ `Vertical Ft. Gained`,
  type = 'treemap',
  marker=list(colors=col[["name"]]),
  marker = list(`Runs` = ~`Runs`),
  hovertemplate = "Chair lift: %{label}<br>We've ridden up %{value} ft. on %{label}!<extra></extra>"
) %>% 
  layout(title= list(text = ""))

```
<sup>*Hover over each box to see how much vertical feet we have gained on each chairlift at Mt. Hood Meadows ski resort!*</sup>

**By number of runs**

```{r, echo = FALSE,  out.height= "100%", out.width = "100%"}

plot_ly(
  hood_runs_tree,
  labels = ~Runs,
  parents = NA,
  values = ~ `Total Runs`,
  type = 'treemap',
  marker=list(colors=col[["name"]]),
  marker = list(`Runs` = ~`Runs`),
  hovertemplate = "Chair lift: %{label}<br>We've ridden %{label} %{value} times!<extra></extra>"
) %>% 
  layout(title= list(text = ""))

```
<sup>*Hover over each box to see how many times we have taken each chairlift at Mt. Hood Meadows ski resort!*</sup>

## Market<br>Comparisons {.tabset .tabset-fade .tabset-pills}

<center><img src="sp500dow.png" width="80%"/></center>

**As you can see in the tabs below,** our relationship milestones seem to have a huge impact of the S&P 500 and Dow Jones Market increases. Since we first met, both the S&P 500 and Dow Jones the markets have risen dramatically! We like to contribute their success to our milestones.

### Market Trends {.tabset .tabset-fade .tabset-pills}

**The S&P 500 Market & our milestones**

```{r, echo = FALSE,  out.height= "100%", out.width = "100%", warning = FALSE}
sp500 <- macro_data$`S&P 500`


sp500 <- sp500 %>% 
  mutate(Date = as_date(Date)) %>% 
  select(Date, `Close/Last`) %>% 
  mutate(source = "S&P 500")


sp500_graph <- ggplot(sp500, aes(x = Date, y = `Close/Last`) )+
 geom_line(linewidth = .6) + 
#  scale_y_continuous("S&P500", sec.axis = sec_axis(~(.), name = "Dow Jones"), limits = c(3500, max(sp500$`Close`)), , expand = c(0, 0, .14, 0)) +
  theme_classic() +
  scale_y_continuous(limits = c(3500, max(sp500$`Close/Last`)), expand = c(0, 0, .14, 0)) +
  labs(title="", x="", color = "Special Event") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") +

  geom_point(aes(x = (`Tinder Match`)   , y = max(`Close/Last`) , color = "Tinder Match"    ), shape=18, size = 4) +    
  geom_point(aes(x = (`First Kiss`)     , y = max(`Close/Last`) , color = "First Kiss"      ), shape=18, size = 4) +
  geom_point(aes(x = (`New York`)       , y = max(`Close/Last`) , color = "New York"        ), shape=18, size = 4) +
  geom_point(aes(x = (`Snowboarding`)   , y = max(`Close/Last`) , color = "Snowboarding"    ), shape=18, size = 4) +
  geom_point(aes(x = (`Meet Parents`)   , y = max(`Close/Last`) , color = "Meet Parents"    ), shape=18, size = 4) +
  geom_point(aes(x = (Relationship)     , y = max(`Close/Last`) , color = "Relationship"    ), shape=18, size = 4) +
  geom_point(aes(x = (`Neil Meets Ben`) , y = max(`Close/Last`) , color = "Neil Meets Ben"  ), shape=18, size = 4) +
  geom_point(aes(x = (`Build Furniture`), y = max(`Close/Last`) , color = "Build Furniture" ), shape=18, size = 4) +
  geom_point(aes(x = (`Duck Fence`)     , y = max(`Close/Last`) , color = "Duck Fence"      ), shape=18, size = 4) +
  geom_point(aes(x = (`Chicago`)        , y = max(`Close/Last`) , color = "Chicago"         ), shape=18, size = 4) +
  geom_point(aes(x = (`Duck Pond`)      , y = max(`Close/Last`) , color = "Duck Pond"       ), shape=18, size = 4) +
  geom_point(aes(x = (`Dirt Bikes`)     , y = max(`Close/Last`) , color = "Dirt Bikes"      ), shape=18, size = 4) +
  geom_point(aes(x = (`Neil moves in` ) , y = max(`Close/Last`) , color = "Neil moves in"   ), shape=18, size = 4) +
  geom_point(aes(x = (`Scuba Diving` )  , y = max(`Close/Last`) , color = "Scuba Diving"    ), shape=18, size = 4) +
  geom_point(aes(x = (`We Get Engaged!`), y = max(`Close/Last`) , color = "We Get Engaged!" ), shape=18, size = 4) +   
  geom_point(aes(x = (`Tahiti Trip`)    , y = max(`Close/Last`) , color = "Tahiti Trip"     ), shape=18, size = 4) +
  geom_point(aes(x = (`We Buy Property`), y = max(`Close/Last`) , color = "We Buy Property" ), shape=18, size = 4) +
  
  
  geom_segment(aes(x=       (`Tinder Match`)            ,       xend=   (`Tinder Match`)                        , y=3500, yend= `Close/Last` , color =                          "Tinder Match"                        ), linewidth = .05) +
  geom_segment(aes(x=       (`First Kiss`)            ,         xend=   (`First Kiss`)                          , y=3500, yend= `Close/Last` , color =                            "First Kiss"                        ), linewidth = .05) +
  geom_segment(aes(x=       (`New York`)              ,         xend=   (`New York`)                            , y=3500, yend= `Close/Last` , color =                             "New York"                         ), linewidth = .05) +
  geom_segment(aes(x=       (`Snowboarding`)          ,         xend=   (`Snowboarding`)                        , y=3500, yend= `Close/Last` , color =                            "Snowboarding"                      ), linewidth = .05) +
  geom_segment(aes(x=       (`Meet Parents`)          ,         xend=   (`Meet Parents`)                        , y=3500, yend= `Close/Last` , color =                            "Meet Parents"                      ), linewidth = .05) +
  geom_segment(aes(x=       (Relationship)            ,         xend=   (Relationship)                          , y=3500, yend= `Close/Last` , color =                            "Relationship"                      ), linewidth = .05) +
  geom_segment(aes(x=       (`Neil Meets Ben`)        ,         xend=   (`Neil Meets Ben`)                      , y=3500, yend= `Close/Last` , color =                            "Neil Meets Ben"                    ), linewidth = .05) +
  geom_segment(aes(x=       (`Build Furniture`)       ,         xend=   (`Build Furniture`)                     , y=3500, yend= `Close/Last` , color =                            "Build Furniture"                   ), linewidth = .05) +
  geom_segment(aes(x=       (`Duck Fence`)            ,         xend=   (`Duck Fence`)                          , y=3500, yend= `Close/Last` , color =                            "Duck Fence"                        ), linewidth = .05) +
  geom_segment(aes(x=       (`Chicago`)               ,         xend=   (`Chicago`)                             , y=3500, yend= `Close/Last` , color =                            "Chicago"                           ), linewidth = .05) +
  geom_segment(aes(x=       (`Duck Pond`)             ,         xend=   (`Duck Pond`)                           , y=3500, yend= `Close/Last` , color =                            "Duck Pond"                         ), linewidth = .05) +
  geom_segment(aes(x=       (`Dirt Bikes`)            ,         xend=   (`Dirt Bikes`)                          , y=3500, yend= `Close/Last` , color =                            "Dirt Bikes"                        ), linewidth = .05) +
  geom_segment(aes(x=       (`Neil moves in` )        ,         xend=   (`Neil moves in` )                      , y=3500, yend= `Close/Last` , color =                            "Neil moves in"                     ), linewidth = .05) +
  geom_segment(aes(x=       (`Scuba Diving` )         ,         xend=   (`Scuba Diving` )                       , y=3500, yend= `Close/Last` , color =                            "Scuba Diving"                      ), linewidth = .05) +
  geom_segment(aes(x=       (`We Get Engaged!`)       ,         xend=   (`We Get Engaged!`)                     , y=3500, yend= `Close/Last` , color =                            "We Get Engaged!"                   ), linewidth = .05) +
  geom_segment(aes(x=       (`Tahiti Trip`)           ,         xend=   (`Tahiti Trip`)                         , y=3500, yend= `Close/Last` , color =                            "Tahiti Trip"                       ), linewidth = .05) +
  geom_segment(aes(x=       (`We Buy Property`)       ,         xend=   (`We Buy Property`)                     , y=3500, yend= `Close/Last` , color =                            "We Buy Property"                   ), linewidth = .05) 
  


ggplotly(sp500_graph) %>% 
  layout(hovermode = 'x') %>%
  style(hovertext = paste0("We matched on Tinder on "                                          , format(as_date(`Tinder Match`), "%b %d, %Y"), "!")                                                                                      , traces = 2  ) %>% 
  style(hovertext = paste0("Our first kiss was on "                                            , format(as_date(`First Kiss`), "%b %d, %Y"), "!")                                                                                      , traces = 3  ) %>% 
  style(hovertext = paste0("We take our first trip to New York together on "                   , format(as_date(`New York`), "%b %d, %Y"), ".\nThis is also the first time Neil Met Karina's parents.")                               , traces = 4  ) %>% 
  style(hovertext = paste0("Our first time ever snowboarding together was on "                 , format(as_date(`Snowboarding`), "%b %d, %Y"), ".\nNeil proved he can shred to Karina!")                                              , traces = 5  ) %>% 
  style(hovertext = paste0("Karina flies to Alpine, CA to meet Neil's parents on "             , format(as_date(`Meet Parents`), "%b %d, %Y"), ".\nWe played card games all New Years Eve and kissed at midnight!")                   , traces = 6  ) %>% 
  style(hovertext = paste0("We make it official, we decide we want to be in a relationship on" , format(as_date(Relationship), "%b %d, %Y"), '.\nWe also said "I love you" in person for the first time on this day.')                , traces = 7  ) %>% 
  style(hovertext = paste0("We go snow boarding with Karina's son, Ben, on "                   , format(as_date(`Neil Meets Ben`), "%b %d, %Y"), ".\nIt's the first time Neil met Ben.")                                                , traces = 8  ) %>% 
  style(hovertext = paste0("We build our first piece of IKEA furniture together on "           , format(as_date(`Build Furniture`), "%b %d, %Y"), ".\nSafe to say we didn't fight while building it.")                                         , traces = 9  ) %>% 
  style(hovertext = paste0("We built a duck fence on "                                         , format(as_date(`Duck Fence`), "%b %d, %Y"), ".\nOur first outside project!")                                                           , traces = 10 ) %>% 
  style(hovertext = paste0("We take a trip to Chicago on "                                     , format(as_date(`Chicago`), "%b %d, %Y"), ".\nNeil got to meet some of Karina's grad school peers.")                                    , traces = 11 ) %>% 
  style(hovertext = paste0("We built a duck pond on "                                          , format(as_date(`Duck Pond`), "%b %d, %Y"), ".\nA continuation of the duck fence project.")                                             , traces =  12) %>% 
  style(hovertext = paste0("We bought our dirt bikes on "                                      , format(as_date(`Dirt Bikes`), "%b %d, %Y"), ".\nWe each have a Yamaha TTR230 and we love them!")                                       , traces =  13) %>% 
  style(hovertext = paste0("Neil moved in with Karina on "                                     , format(as_date(`Neil moves in`), "%b %d, %Y"), ".")                                                                                   , traces =  14) %>% 
  style(hovertext = paste0("We go scuba diving for the first time in Key Largo, FL on "        , format(as_date(`Scuba Diving`), "%b %d, %Y"), "!")                                                                                    , traces =  15) %>%
  style(hovertext = paste0("We got engaged on "                                                , format(as_date(`We Get Engaged!`), "%b %d, %Y"), "!\nNeil hired a photographer to capture the moment at Mt. Hood Meadows ski resort.") , traces = 16 ) %>%
  style(hovertext = paste0("We take our first trip as an engaged coupel to Tahiti on"          , format(as_date(`Tahiti Trip`), "%b %d, %Y"), ".\nWe sailed on a Yach to different islabds for 10 days!")                               , traces =  17) %>% 
  style(hovertext = paste0("We bought a 1 acre piece of land in La Pine, OR on "               , format(as_date(`We Buy Property`), "%b %d, %Y"), ".\nOur plan is to build a getaway cabin on the land!")                               , traces =  18) %>% 
  style(hoverinfo = "none", traces = 19:35)

```
<sup>*Hover over the chart and milestones for more information about our milestones and the market price. Or click on the chart legend to show/hide any trends.*</sup>

**The Dow Jones Market & our Milestones**

```{r, echo = FALSE,  out.height= "100%", out.width = "100%", warning = FALSE}
dowjones <- macro_data$`Dow Jones`

dowjones <- dowjones %>% 
  mutate(Date = as_date(Date)) %>% 
  filter(Date < "2024-8-22") %>% 
  select(Date, `Close/Last` = "Close") %>% 
  mutate(source = "Dow Jones") 


dowjones_graph <- ggplot(dowjones, aes(x = Date, y = `Close/Last`) )+
 geom_line(linewidth = .6) + 
#  scale_y_continuous("S&P500", sec.axis = sec_axis(~(.), name = "Dow Jones"), limits = c(3500, max(sp500$`Close`)), , expand = c(0, 0, .14, 0)) +
  theme_classic() +
  scale_y_continuous(limits = c(27000, max(dowjones$`Close/Last`)), expand = c(0, 0, .14, 0)) +
  labs(title="", x="", color = "Special Event") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  +
  scale_x_date(date_labels="%b %Y",date_breaks  ="1 month") +

  geom_point(aes(x = (`Tinder Match`)   , y = max(`Close/Last`) , color = "Tinder Match"    ), shape=18, size = 4) +    
  geom_point(aes(x = (`First Kiss`)     , y = max(`Close/Last`) , color = "First Kiss"      ), shape=18, size = 4) +
  geom_point(aes(x = (`New York`)       , y = max(`Close/Last`) , color = "New York"        ), shape=18, size = 4) +
  geom_point(aes(x = (`Snowboarding`)   , y = max(`Close/Last`) , color = "Snowboarding"    ), shape=18, size = 4) +
  geom_point(aes(x = (`Meet Parents`)   , y = max(`Close/Last`) , color = "Meet Parents"    ), shape=18, size = 4) +
  geom_point(aes(x = (Relationship)     , y = max(`Close/Last`) , color = "Relationship"    ), shape=18, size = 4) +
  geom_point(aes(x = (`Neil Meets Ben`) , y = max(`Close/Last`) , color = "Neil Meets Ben"  ), shape=18, size = 4) +
  geom_point(aes(x = (`Build Furniture`), y = max(`Close/Last`) , color = "Build Furniture" ), shape=18, size = 4) +
  geom_point(aes(x = (`Duck Fence`)     , y = max(`Close/Last`) , color = "Duck Fence"      ), shape=18, size = 4) +
  geom_point(aes(x = (`Chicago`)        , y = max(`Close/Last`) , color = "Chicago"         ), shape=18, size = 4) +
  geom_point(aes(x = (`Duck Pond`)      , y = max(`Close/Last`) , color = "Duck Pond"       ), shape=18, size = 4) +
  geom_point(aes(x = (`Dirt Bikes`)     , y = max(`Close/Last`) , color = "Dirt Bikes"      ), shape=18, size = 4) +
  geom_point(aes(x = (`Neil moves in` ) , y = max(`Close/Last`) , color = "Neil moves in"   ), shape=18, size = 4) +
  geom_point(aes(x = (`Scuba Diving` )  , y = max(`Close/Last`) , color = "Scuba Diving"    ), shape=18, size = 4) +
  geom_point(aes(x = (`We Get Engaged!`), y = max(`Close/Last`) , color = "We Get Engaged!" ), shape=18, size = 4) +   
  geom_point(aes(x = (`Tahiti Trip`)    , y = max(`Close/Last`) , color = "Tahiti Trip"     ), shape=18, size = 4) +
  geom_point(aes(x = (`We Buy Property`), y = max(`Close/Last`) , color = "We Buy Property" ), shape=18, size = 4) +
  
  
  geom_segment(aes(x=       (`Tinder Match`)            ,       xend=   (`Tinder Match`)                        , y=27000, yend= `Close/Last` , color =                          "Tinder Match"                        ), linewidth = .05) +
  geom_segment(aes(x=       (`First Kiss`)            ,         xend=   (`First Kiss`)                          , y=27000, yend= `Close/Last` , color =                            "First Kiss"                        ), linewidth = .05) +
  geom_segment(aes(x=       (`New York`)              ,         xend=   (`New York`)                            , y=27000, yend= `Close/Last` , color =                             "New York"                         ), linewidth = .05) +
  geom_segment(aes(x=       (`Snowboarding`)          ,         xend=   (`Snowboarding`)                        , y=27000, yend= `Close/Last` , color =                            "Snowboarding"                      ), linewidth = .05) +
  geom_segment(aes(x=       (`Meet Parents`)          ,         xend=   (`Meet Parents`)                        , y=27000, yend= `Close/Last` , color =                            "Meet Parents"                      ), linewidth = .05) +
  geom_segment(aes(x=       (Relationship)            ,         xend=   (Relationship)                          , y=27000, yend= `Close/Last` , color =                            "Relationship"                      ), linewidth = .05) +
  geom_segment(aes(x=       (`Neil Meets Ben`)        ,         xend=   (`Neil Meets Ben`)                      , y=27000, yend= `Close/Last` , color =                            "Neil Meets Ben"                    ), linewidth = .05) +
  geom_segment(aes(x=       (`Build Furniture`)       ,         xend=   (`Build Furniture`)                     , y=27000, yend= `Close/Last` , color =                            "Build Furniture"                   ), linewidth = .05) +
  geom_segment(aes(x=       (`Duck Fence`)            ,         xend=   (`Duck Fence`)                          , y=27000, yend= `Close/Last` , color =                            "Duck Fence"                        ), linewidth = .05) +
  geom_segment(aes(x=       (`Chicago`)               ,         xend=   (`Chicago`)                             , y=27000, yend= `Close/Last` , color =                            "Chicago"                           ), linewidth = .05) +
  geom_segment(aes(x=       (`Duck Pond`)             ,         xend=   (`Duck Pond`)                           , y=27000, yend= `Close/Last` , color =                            "Duck Pond"                         ), linewidth = .05) +
  geom_segment(aes(x=       (`Dirt Bikes`)            ,         xend=   (`Dirt Bikes`)                          , y=27000, yend= `Close/Last` , color =                            "Dirt Bikes"                        ), linewidth = .05) +
  geom_segment(aes(x=       (`Neil moves in` )        ,         xend=   (`Neil moves in` )                      , y=27000, yend= `Close/Last` , color =                            "Neil moves in"                     ), linewidth = .05) +
  geom_segment(aes(x=       (`Scuba Diving` )         ,         xend=   (`Scuba Diving` )                       , y=27000, yend= `Close/Last` , color =                            "Scuba Diving"                      ), linewidth = .05) +
  geom_segment(aes(x=       (`We Get Engaged!`)       ,         xend=   (`We Get Engaged!`)                     , y=27000, yend= `Close/Last` , color =                            "We Get Engaged!"                   ), linewidth = .05) +
  geom_segment(aes(x=       (`Tahiti Trip`)           ,         xend=   (`Tahiti Trip`)                         , y=27000, yend= `Close/Last` , color =                            "Tahiti Trip"                       ), linewidth = .05) +
  geom_segment(aes(x=       (`We Buy Property`)       ,         xend=   (`We Buy Property`)                     , y=27000, yend= `Close/Last` , color =                            "We Buy Property"                   ), linewidth = .05) 
  


ggplotly(dowjones_graph) %>% 
  layout(hovermode = 'x') %>%
  style(hovertext = paste0("We matched on Tinder on "                                          , format(as_date(`Tinder Match`), "%b %d, %Y"), "!")                                                                                      , traces = 2  ) %>% 
  style(hovertext = paste0("Our first kiss was on "                                            , format(as_date(`First Kiss`), "%b %d, %Y"), "!")                                                                                      , traces = 3  ) %>% 
  style(hovertext = paste0("We take our first trip to New York together on "                   , format(as_date(`New York`), "%b %d, %Y"), ".\nThis is also the first time Neil Met Karina's parents.")                               , traces = 4  ) %>% 
  style(hovertext = paste0("Our first time ever snowboarding together was on "                 , format(as_date(`Snowboarding`), "%b %d, %Y"), ".\nNeil proved he can shred to Karina!")                                              , traces = 5  ) %>% 
  style(hovertext = paste0("Karina flies to Alpine, CA to meet Neil's parents on "             , format(as_date(`Meet Parents`), "%b %d, %Y"), ".\nWe played card games all New Years Eve and kissed at midnight!")                   , traces = 6  ) %>% 
  style(hovertext = paste0("We make it official, we decide we want to be in a relationship on" , format(as_date(Relationship), "%b %d, %Y"), '.\nWe also said "I love you" in person for the first time on this day.')                , traces = 7  ) %>% 
  style(hovertext = paste0("We go snow boarding with Karina's son, Ben, on "                   , format(as_date(`Neil Meets Ben`), "%b %d, %Y"), ".\nIt's the first time Neil met Ben.")                                                , traces = 8  ) %>% 
  style(hovertext = paste0("We build our first piece of IKEA furniture together on "           , format(as_date(`Build Furniture`), "%b %d, %Y"), ".\nSafe to say we didn't fight while building it.")                                         , traces = 9  ) %>% 
  style(hovertext = paste0("We built a duck fence on "                                         , format(as_date(`Duck Fence`), "%b %d, %Y"), ".\nOur first outside project!")                                                           , traces = 10 ) %>% 
  style(hovertext = paste0("We take a trip to Chicago on "                                     , format(as_date(`Chicago`), "%b %d, %Y"), ".\nNeil got to meet some of Karina's grad school peers.")                                    , traces = 11 ) %>% 
  style(hovertext = paste0("We built a duck pond on "                                          , format(as_date(`Duck Pond`), "%b %d, %Y"), ".\nA continuation of the duck fence project.")                                             , traces =  12) %>% 
  style(hovertext = paste0("We bought our dirt bikes on "                                      , format(as_date(`Dirt Bikes`), "%b %d, %Y"), ".\nWe each have a Yamaha TTR230 and we love them!")                                       , traces =  13) %>% 
  style(hovertext = paste0("Neil moved in with Karina on "                                     , format(as_date(`Neil moves in`), "%b %d, %Y"), ".")                                                                                   , traces =  14) %>% 
  style(hovertext = paste0("We go scuba diving for the first time in Key Largo, FL on "        , format(as_date(`Scuba Diving`), "%b %d, %Y"), "!")                                                                                    , traces =  15) %>%
  style(hovertext = paste0("We got engaged on "                                                , format(as_date(`We Get Engaged!`), "%b %d, %Y"), "!\nNeil hired a photographer to capture the moment at Mt. Hood Meadows ski resort.") , traces = 16 ) %>%
  style(hovertext = paste0("We take our first trip as an engaged coupel to Tahiti on"          , format(as_date(`Tahiti Trip`), "%b %d, %Y"), ".\nWe sailed on a Yach to different islabds for 10 days!")                               , traces =  17) %>% 
  style(hovertext = paste0("We bought a 1 acre piece of land in La Pine, OR on "               , format(as_date(`We Buy Property`), "%b %d, %Y"), ".\nOur plan is to build a getaway cabin on the land!")                               , traces =  18) %>% 
  style(hoverinfo = "none", traces = 19:35)


```
<sup>*Hover over the chart and milestones for more information about our milestones and the market price. Or click on the chart legend to show/hide any trends.*</sup>

## Texting Data & Market <br>Correlates {.tabset .tabset-fade .tabset-pills}

**For fun, we decided to see if our texting data is predictive of the S&P 500 and Dow Jones market prices.** **We share a passion for working with quantitative data and this was a fun way for us to show off that passion.**

When correlated to the absolute market prices (controlling for time), our texting is predictive of the change in the absolute market price. The relationship is positive and statistically significant.

However, when compared to the daily difference between the start/close of each market price(controlling for time), our models were no longer predictive.

### Main Effect Model Tables and visuals {.tabset .tabset-fade .tabset-pills}

```{r, message = FALSE, warning = FALSE, echo = FALSE, out.height= "100%", out.width = "100%" }

reg_table <- numdffinal %>% 
  left_join(estimatefinal, by = "name") %>% 
  left_join(dendffinal   , by = "name") %>% 
  left_join(ffinal       , by = "name") %>% 
  left_join(pvalfinal    , by = "name") %>% 
  left_join(rfinal       , by = "name") %>% 
  left_join(r2final      , by = "name") %>% 
  mutate(`Degrees of Freedom` = paste0("(", `Numerator DF`, ", " , `Denominator DF`, ")")) %>% 
  select(`Market Name` = "name", `Unstandardized Beta`, `Degrees of Freedom`, `F-value`, `p-value`, R, `R-squared`) %>% 
  mutate_if(is.numeric, round, 2) %>% 
  mutate(
    `Unstandardized Beta`   = ifelse(`Unstandardized Beta`     == 0.00, "< 0.01", `Unstandardized Beta`),
    `F-value`               = ifelse(`F-value`                 == 0.00, "< 0.01", `F-value`    ),
    `p-value`               = ifelse(`p-value`                 == 0.00, "< 0.01", `p-value`    ),
    R                       = ifelse( R                        == 0.00, "< 0.01",  R           ),
    `R-squared`             = ifelse(`R-squared`               == 0.00, "< 0.01", `R-squared`  ),
    
    `Market Name` = ifelse(`Market Name` == "sp500", "S&P 500 close price (Absolute)", `Market Name`),
    `Market Name` = ifelse(`Market Name` == "sp500 difference", "S&P 500 close price (Daily Difference)", `Market Name`),
    `Market Name` = ifelse(`Market Name` == "Dow Jones", "Dow Jones close price (Absolute)", `Market Name`),
    `Market Name` = ifelse(`Market Name` == "Dow Jones difference", "Dow Jones close price (Daily Difference)", `Market Name`)
  ) 


reg_table %>% 
  kbl(align = "c", escape = FALSE) %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width = TRUE, font_size = 16) %>% 
  add_footnote(label = "\nPredictor variable = Daily quanitity of texts sent between Neil and Karina\nOutcome variable = Corresponding market closing price (Absolute closing value or Daily difference closing value)\nAll models controlled for time",notation = "none")
  

```

**Model Scatterplots**

#### S&P 500 (Absolute) {.tabset .tabset-fade .tabset-pills}

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}

textcount_sp500 <- textcount_sp500 %>% 
  mutate(SP500_Closing_Price = `Close/Last`,
         Number_of_texts_sent = n_texts,
         `Days_since_first_text` = as.numeric(as_date(Date) - min(as_date(Date)))
        )


model <- lm(SP500_Closing_Price ~ Number_of_texts_sent + `Days_since_first_text` , data = textcount_sp500)
ggPredict(model, se = TRUE, colorn = 4, interactive = TRUE, terms = "Number_of_texts_sent") 

```

This model *is* statistically significant: F(2,408) = 2003.30, p \<.01, R<sup>2</sup> = 0.91. Suggesting that, for every 1 text we send, the S&P 500 market price is expected to increase 0.47 points, after controlling for time. The beta (slope) for our texts was significant at p \< 0.05, indicating that, after controlling for time, our texts have a *very very slight* influence on the market. The overall model explains 91% of the variance in the market price (Mostly explained by time, but it's fun to think our texts influence it a little bit!).

#### S&P 500 (Daily Difference) {.tabset .tabset-fade .tabset-pills}

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}



textcount_sp500_diff <- textcount_sp500_diff %>% 
  mutate(SP500_Daily_Closing_Difference_Price = diff,
         Number_of_texts_sent = n_texts,
         `Days_since_first_text` = as.numeric(as_date(Date) - min(as_date(Date)))
        )


model <- lm(SP500_Daily_Closing_Difference_Price ~ Number_of_texts_sent + `Days_since_first_text` , data = textcount_sp500_diff)
ggPredict(model, se = TRUE, colorn = 4, interactive = TRUE, terms = "Number_of_texts_sent") 
```

This model is *not* statistically significant: F(2,408) = 0.11, p \>.05, R<sup>2</sup> \< 0.01.

#### Dow Jones (Absolute) {.tabset .tabset-fade .tabset-pills}

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}

textcount_dj <- textcount_dj %>% 
  mutate(Dow_Jones_Daily_Closing_Price = Close,
         Number_of_texts_sent = n_texts,
         `Days_since_first_text` = as.numeric(as_date(Date) - min(as_date(Date)))
        )


model <- lm(Dow_Jones_Daily_Closing_Price~ Number_of_texts_sent + `Days_since_first_text` , data = textcount_dj)
ggPredict(model, se = TRUE, colorn = 4, interactive = TRUE) 



```

This model *is* statistically significant: F(2,408) = 750.28, p \<.01, R<sup>2</sup> = 0.79. Suggesting that, for every 1 text we send, the Dow Jones market price is expected to increase 3.49 points, after controlling for time. The beta (slope) for our texts was significant at p \< 0.05, indicating that, after controlling for time, our texts have a *very very slight* influence on the market. The overall model explains 79% of the variance in the market price (Mostly explained by time, but it's fun to think our texts influence it a little bit!).

#### Dow Jones (Daily Difference) {.tabset .tabset-fade .tabset-pills}

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}


textcount_dj_diff <- textcount_dj_diff %>% 
  mutate(Dow_Jones_Daily_Closing_Difference_Price = diff,
         Number_of_texts_sent = n_texts,
         `Days_since_first_text` = as.numeric(as_date(Date) - min(as_date(Date)))
        )


model <- lm(Dow_Jones_Daily_Closing_Difference_Price ~ Number_of_texts_sent + `Days_since_first_text` , data = textcount_dj_diff)
ggPredict(model, se = TRUE, colorn = 4, interactive = TRUE) 
```

This model is *not* statistically significant: F(2,408) = 0.04, p \>.05, R<sup>2</sup> \< 0.01.

### Interaction Model Table and Visuals {.tabset .tabset-fade .tabset-pills}

For the more statistically fluent, we also found an interaction between number of texts sent & time on the S&P 500 absolute closing price. As can be seen in the models below, in the beginning of our relationship, our texts were predictive of an increase in the market values. However, the more time that passes, the relationship between our texting and market value turns negative! Therefore, the more time that passes, and the more we text, the worse the absolute market value is expected to be!

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}

reg_table_in <- numdffinal_in %>% 
  left_join(estimatefinal_in, by = "name") %>% 
  left_join(estimatefinal_in2, by = "name") %>% 
  left_join(dendffinal_in   , by = "name") %>% 
  left_join(ffinal_in       , by = "name") %>% 
  left_join(pvalfinal_in    , by = "name") %>% 
  left_join(rfinal_in       , by = "name") %>% 
  left_join(r2final_in      , by = "name") %>% 
  mutate(`Degrees of Freedom` = paste0("(", `Numerator DF`, ", " , `Denominator DF`, ")")) %>% 
  select(`Market Name` = "name", `Unstandardized Beta (texts)` = "Unstandardized Beta", `Unstandardized Beta (texts*time)`,  `Degrees of Freedom`, `F-value`, `p-value`, R, `R-squared`) %>% 
  mutate_if(is.numeric, round, 2) %>% 
  mutate(`Unstandardized Beta (texts*time)` = round(estimatefinal_in2$`Unstandardized Beta (texts*time)`, 4),
    `Unstandardized Beta (texts)`   = ifelse(`Unstandardized Beta (texts)`     == 0.00, "< 0.01", `Unstandardized Beta (texts)`),
    `F-value`               = ifelse(`F-value`                 == 0.00, "< 0.01", `F-value`    ),
    `p-value`               = ifelse(`p-value`                 == 0.00, "< 0.01", `p-value`    ),
    R                       = ifelse( R                        == 0.00, "< 0.01",  R           ),
    `R-squared`             = ifelse(`R-squared`               == 0.00, "< 0.01", `R-squared`  ),
    
    `Market Name` = ifelse(`Market Name` == "sp500", "S&P 500 close price (Absolute)", `Market Name`),
    `Market Name` = ifelse(`Market Name` == "sp500 difference", "S&P 500 close price (Daily Difference)", `Market Name`),
    `Market Name` = ifelse(`Market Name` == "Dow Jones", "Dow Jones close price (Absolute)", `Market Name`),
    `Market Name` = ifelse(`Market Name` == "Dow Jones difference", "Dow Jones close price (Daily Difference)", `Market Name`)
  ) 


reg_table_in %>% 
  kbl(align = "c", escape = FALSE) %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width = TRUE, font_size = 16) %>% 
  add_footnote(label = "\nPredictor variable = Daily quanitity of texts sent between Neil and Karina\nOutcome variable = Corresponding market closing price (Absolute closing value or Daily difference closing value)\nAll models controlled for time and the interaction term between texting and time is included",notation = "none")

```

#### S&P 500 interaction (Absolute) {.tabset .tabset-fade .tabset-pills}

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}
model <- lm( `SP500_Closing_Price` ~ Number_of_texts_sent + `Days_since_first_text` + Number_of_texts_sent*`Days_since_first_text`, data = textcount_sp500)
#summary(model)

ggPredict(model, se = TRUE,  interactive = TRUE, terms = c("n_texts", "Days_since_first_text")) 
```

This model *is* statistically significant: F(3,407) = 1347.84, p \<.01, R<sup>2</sup> = 0.91. Suggesting that, for every 1 text we send, the S&P 500 market price is expected to increase 1.07 points - however, for every day that passes, the beta (slope) is expected to *decrease* by 0.0028 points. The chart above shows the expected change in slope at 0, 200, 400, 600, & 800 days since we started texting. As can be seen from the chart above, after enough time, the relationship turns from positive to negative!

## Financial<br>Data {.tabset .tabset-fade .tabset-pills}

### Our Overall Spending Habits {.tabset .tabset-fade .tabset-pills}

Each square below corresponds to the percentage we spend on selected categories. We seem especially interested in spending money on bars/restaraunts and Amazon products!

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%" }


plot_ly(
  finance_summ,
  labels = ~`Proposed Category`,
  parents = NA,
  values = ~ Amount,
  type = 'treemap',
   marker=list(colors=col[["name"]]),
  marker = list(`Proposed Category` = ~`Proposed Category`),
  hovertemplate = "%{value}% of our spending is on %{label}.<extra></extra>"
) %>% 
  layout(title= list(text = ""))

```
<sup>*Hover over each box to see what percentage we spend on each category*</sup>

### Our Individual Spending Habits {.tabset .tabset-fade .tabset-pills}

**Karina's Spending**

Karina spends the most percentage of her money on Amazon purchases and other merchandise!

```{r, message = FALSE, warning = FALSE, echo = FALSE, out.height= "100%", out.width = "100%" }
Karina_fig <- plot_ly(
  finance_summ_Karina,
  labels = ~`Proposed Category`,
  parents = NA,
  values = ~ Amount,
  type = 'treemap',
   marker=list(colors=col[["name"]]),
  marker = list(`Proposed Category` = ~`Proposed Category`),
  hovertemplate = "%{value}% of Karina's spending is on %{label}.<extra></extra>"
) 

Karina_fig
```
<sup>*Hover over each box to see what percentage Karina spends on each category.*</sup>

**Neil's Spending**

Neil spends the majority of his money on bars & Restaurants. Makes sense, he loves to eat and drink!

```{r, message = FALSE, warning = FALSE, echo = FALSE,  out.height= "100%", out.width = "100%"}

Neil_fig <- plot_ly(
  finance_summ_Neil,
  labels = ~`Proposed Category`,
  parents = NA,
  values = ~Amount,
  type = 'treemap',
 # color = ~`Proposed Category`,
  marker=list(colors=col[["name"]]),
 # marker = list(`Proposed Category` = ~`Proposed Category`),
  hovertemplate = "%{value}% of Neil's spending is on %{label}.<extra></extra>"
) 


Neil_fig
```
<sup>*Hover over each box to see what percentage Neil spends on each category.*</sup>

# 

<center><img src="KN.png" width="20%"/></center>

<center><img src="final_image.png" width="20%"/></center>

~InterestedÂ inÂ howÂ theseÂ chartsÂ wereÂ made?:Â [ClickÂ hereÂ toÂ seeÂ ourÂ GithubÂ repository!](https://github.com/ndyetz/ourloveinnumbers.github.io)~
